---
title: 'Vertex AI Searchë¡œ ì‚¬ì´íŠ¸ ë‚´ ê²€ìƒ‰ êµ¬í˜„í•˜ê¸°: Cloud Functionsì™€ ìë™í™” ë°°í¬'
description: >-
  Google Vertex AI Searchë¥¼ í™œìš©í•´ ì›¹ì‚¬ì´íŠ¸ì— AI ê²€ìƒ‰ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤. Cloud Functions
  API ì„œë²„ êµ¬ì¶•ë¶€í„° ì…¸ ìŠ¤í¬ë¦½íŠ¸ ìë™í™” ë°°í¬ê¹Œì§€ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.
pubDate: '2025-11-30'
heroImage: ../../../assets/blog/vertex-ai-search-site-implementation-hero.jpg
tags:
  - vertex-ai
  - google-cloud
  - cloud-functions
  - search
relatedPosts:
  - slug: adding-chinese-support
    score: 0.94
    reason:
      ko: 'ìë™í™”, ì›¹ ê°œë°œ, AI/ML, DevOps, ì•„í‚¤í…ì²˜ ë¶„ì•¼ì—ì„œ ìœ ì‚¬í•œ ì£¼ì œë¥¼ ë‹¤ë£¨ë©° ë¹„ìŠ·í•œ ë‚œì´ë„ì…ë‹ˆë‹¤.'
      ja: è‡ªå‹•åŒ–ã€Webé–‹ç™ºã€AI/MLã€DevOpsã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†é‡ã§é¡ä¼¼ã—ãŸãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã„ã€åŒç¨‹åº¦ã®é›£æ˜“åº¦ã§ã™ã€‚
      en: >-
        Covers similar topics in automation, web development, AI/ML, DevOps,
        architecture with comparable difficulty.
      zh: åœ¨è‡ªåŠ¨åŒ–ã€Webå¼€å‘ã€AI/MLã€DevOpsã€æ¶æ„é¢†åŸŸæ¶µç›–ç±»ä¼¼ä¸»é¢˜ï¼Œéš¾åº¦ç›¸å½“ã€‚
  - slug: e2e-page-test-automation-claude-code
    score: 0.94
    reason:
      ko: 'ìë™í™”, ì›¹ ê°œë°œ, AI/ML, DevOps, ì•„í‚¤í…ì²˜ ë¶„ì•¼ì—ì„œ ìœ ì‚¬í•œ ì£¼ì œë¥¼ ë‹¤ë£¨ë©° ë¹„ìŠ·í•œ ë‚œì´ë„ì…ë‹ˆë‹¤.'
      ja: è‡ªå‹•åŒ–ã€Webé–‹ç™ºã€AI/MLã€DevOpsã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†é‡ã§é¡ä¼¼ã—ãŸãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã„ã€åŒç¨‹åº¦ã®é›£æ˜“åº¦ã§ã™ã€‚
      en: >-
        Covers similar topics in automation, web development, AI/ML, DevOps,
        architecture with comparable difficulty.
      zh: åœ¨è‡ªåŠ¨åŒ–ã€Webå¼€å‘ã€AI/MLã€DevOpsã€æ¶æ„é¢†åŸŸæ¶µç›–ç±»ä¼¼ä¸»é¢˜ï¼Œéš¾åº¦ç›¸å½“ã€‚
  - slug: n8n-rss-automation
    score: 0.94
    reason:
      ko: 'ìë™í™”, ì›¹ ê°œë°œ, AI/ML, DevOps, ì•„í‚¤í…ì²˜ ë¶„ì•¼ì—ì„œ ìœ ì‚¬í•œ ì£¼ì œë¥¼ ë‹¤ë£¨ë©° ë¹„ìŠ·í•œ ë‚œì´ë„ì…ë‹ˆë‹¤.'
      ja: è‡ªå‹•åŒ–ã€Webé–‹ç™ºã€AI/MLã€DevOpsã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†é‡ã§é¡ä¼¼ã—ãŸãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã„ã€åŒç¨‹åº¦ã®é›£æ˜“åº¦ã§ã™ã€‚
      en: >-
        Covers similar topics in automation, web development, AI/ML, DevOps,
        architecture with comparable difficulty.
      zh: åœ¨è‡ªåŠ¨åŒ–ã€Webå¼€å‘ã€AI/MLã€DevOpsã€æ¶æ„é¢†åŸŸæ¶µç›–ç±»ä¼¼ä¸»é¢˜ï¼Œéš¾åº¦ç›¸å½“ã€‚
  - slug: notion-backlog-slack-claude-project-management
    score: 0.94
    reason:
      ko: 'ìë™í™”, AI/ML, DevOps, ì•„í‚¤í…ì²˜ ë¶„ì•¼ì—ì„œ ìœ ì‚¬í•œ ì£¼ì œë¥¼ ë‹¤ë£¨ë©° ë¹„ìŠ·í•œ ë‚œì´ë„ì…ë‹ˆë‹¤.'
      ja: è‡ªå‹•åŒ–ã€AI/MLã€DevOpsã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†é‡ã§é¡ä¼¼ã—ãŸãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã„ã€åŒç¨‹åº¦ã®é›£æ˜“åº¦ã§ã™ã€‚
      en: >-
        Covers similar topics in automation, AI/ML, DevOps, architecture with
        comparable difficulty.
      zh: åœ¨è‡ªåŠ¨åŒ–ã€AI/MLã€DevOpsã€æ¶æ„é¢†åŸŸæ¶µç›–ç±»ä¼¼ä¸»é¢˜ï¼Œéš¾åº¦ç›¸å½“ã€‚
  - slug: playwright-ai-testing
    score: 0.94
    reason:
      ko: 'ìë™í™”, ì›¹ ê°œë°œ, AI/ML, DevOps, ì•„í‚¤í…ì²˜ ë¶„ì•¼ì—ì„œ ìœ ì‚¬í•œ ì£¼ì œë¥¼ ë‹¤ë£¨ë©° ë¹„ìŠ·í•œ ë‚œì´ë„ì…ë‹ˆë‹¤.'
      ja: è‡ªå‹•åŒ–ã€Webé–‹ç™ºã€AI/MLã€DevOpsã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†é‡ã§é¡ä¼¼ã—ãŸãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã„ã€åŒç¨‹åº¦ã®é›£æ˜“åº¦ã§ã™ã€‚
      en: >-
        Covers similar topics in automation, web development, AI/ML, DevOps,
        architecture with comparable difficulty.
      zh: åœ¨è‡ªåŠ¨åŒ–ã€Webå¼€å‘ã€AI/MLã€DevOpsã€æ¶æ„é¢†åŸŸæ¶µç›–ç±»ä¼¼ä¸»é¢˜ï¼Œéš¾åº¦ç›¸å½“ã€‚
---

## ê°œìš”

ì›¹ì‚¬ì´íŠ¸ì— ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì€ ì‚¬ìš©ì ê²½í—˜ì„ í¬ê²Œ í–¥ìƒì‹œí‚¤ì§€ë§Œ, ì „í†µì ì¸ ê²€ìƒ‰ ì—”ì§„ì„ ì§ì ‘ êµ¬ì¶•í•˜ëŠ” ê²ƒì€ ë§ì€ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤. Googleì˜ <strong>Vertex AI Search</strong>ëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê´€ë¦¬í˜• ê²€ìƒ‰ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤. ë‹¨ìˆœí•œ í‚¤ì›Œë“œ ë§¤ì¹­ì„ ë„˜ì–´ <strong>ì˜ë¯¸ë¡ ì  ê²€ìƒ‰(Semantic Search)</strong>ê³¼ <strong>AI ìš”ì•½ ê¸°ëŠ¥</strong>ì„ ì œê³µí•˜ì—¬, ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì •ë³´ë¥¼ ë” ë¹ ë¥´ê³  ì •í™•í•˜ê²Œ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

### ê¸°ì¡´ ê²€ìƒ‰ ì†”ë£¨ì…˜ê³¼ì˜ ì°¨ë³„ì 

ì „í†µì ì¸ ê²€ìƒ‰ ì—”ì§„ì€ í‚¤ì›Œë“œ ê¸°ë°˜ ê²€ìƒ‰ì— ì˜ì¡´í•˜ì§€ë§Œ, Vertex AI SearchëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì°¨ë³„í™”ëœ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

- ğŸ§  <strong>ì„¸ë§¨í‹± ê²€ìƒ‰</strong>: í‚¤ì›Œë“œ ë§¤ì¹­ì´ ì•„ë‹Œ ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰
- ğŸ“ <strong>AI ìš”ì•½</strong>: ê²€ìƒ‰ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ ìš”ì•½í•˜ì—¬ ì œê³µ
- ğŸ” <strong>ìë™ ì¸ë±ì‹±</strong>: ì›¹ì‚¬ì´íŠ¸ í¬ë¡¤ë§ ë° ì½˜í…ì¸  ìë™ ìˆ˜ì§‘
- ğŸ“Š <strong>ê²€ìƒ‰ ë¶„ì„</strong>: ì‚¬ìš©ì ê²€ìƒ‰ íŒ¨í„´ ë° ì„±ëŠ¥ ì§€í‘œ ì œê³µ
- ğŸš€ <strong>ì™„ì „ ê´€ë¦¬í˜•</strong>: ì¸í”„ë¼ ê´€ë¦¬ ë¶ˆí•„ìš”

### ì•„í‚¤í…ì²˜ ê°œìš”

ì´ ê¸€ì—ì„œ êµ¬í˜„í•  ì‹œìŠ¤í…œì˜ ì „ì²´ ì•„í‚¤í…ì²˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```mermaid
graph LR
    A[ì›¹ ë¸Œë¼ìš°ì €] -->|ê²€ìƒ‰ ìš”ì²­| B[Cloud Functions API]
    B -->|Discovery Engine API| C[Vertex AI Search]
    C -->|ê²€ìƒ‰ ê²°ê³¼ + AI ìš”ì•½| B
    B -->|JSON ì‘ë‹µ| A

    D[Agent Builder] -.->|ì—”ì§„ ì„¤ì •| C
    E[ì›¹ì‚¬ì´íŠ¸] -.->|ìë™ í¬ë¡¤ë§| C
```

<strong>ì£¼ìš” êµ¬ì„± ìš”ì†Œ</strong>:

1. <strong>Vertex AI Search Engine</strong>: Google Cloudì˜ Agent Builderì—ì„œ ìƒì„±í•œ ê²€ìƒ‰ ì—”ì§„
2. <strong>Cloud Functions</strong>: ê²€ìƒ‰ APIë¥¼ ì œê³µí•˜ëŠ” ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜
3. <strong>ì›¹ í”„ë¡ íŠ¸ì—”ë“œ</strong>: ê²€ìƒ‰ UIë¥¼ ì œê³µí•˜ëŠ” ì›¹í˜ì´ì§€

## ì‚¬ì „ ì¤€ë¹„

### Google Cloud í”„ë¡œì íŠ¸ ì„¤ì •

ë¨¼ì € Google Cloud Consoleì—ì„œ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•©ë‹ˆë‹¤:

```bash
# gcloud CLI ì„¤ì¹˜ (ì•„ì§ ì—†ë‹¤ë©´)
# macOS
brew install google-cloud-sdk

# í”„ë¡œì íŠ¸ ID í™•ì¸
gcloud projects list

# í”„ë¡œì íŠ¸ ì„¤ì •
gcloud config set project YOUR_PROJECT_ID
```

### Vertex AI Search ì—”ì§„ ìƒì„±

Google Cloud Consoleì—ì„œ <strong>Agent Builder</strong>ë¥¼ í†µí•´ ê²€ìƒ‰ ì—”ì§„ì„ ìƒì„±í•©ë‹ˆë‹¤:

1. <strong>Agent Builder ì ‘ì†</strong>
   - Google Cloud Console â†’ "Vertex AI" â†’ "Agent Builder" ë©”ë‰´
   - ë˜ëŠ” ì§ì ‘ URL: `https://console.cloud.google.com/gen-app-builder`

2. <strong>ìƒˆ ì•± ìƒì„±</strong>
   - "Create App" ë²„íŠ¼ í´ë¦­
   - App type: "Search" ì„ íƒ
   - Content: "Website content" ì„ íƒ

3. <strong>ë°ì´í„° ì†ŒìŠ¤ ì„¤ì •</strong>
   - Data source name ì…ë ¥ (ì˜ˆ: `my-website`)
   - Website URLs ì…ë ¥ (í¬ë¡¤ë§í•  ë„ë©”ì¸)
   - Advanced options:
     - Crawling frequency: ë§¤ì¼ ë˜ëŠ” ë§¤ì£¼
     - Max pages: ì œí•œ ì—†ìŒ ë˜ëŠ” íŠ¹ì • ê°’

4. <strong>ì—”ì§„ ìƒì„± ì™„ë£Œ</strong>
   - ìƒì„± í›„ <strong>Engine ID</strong> í™•ì¸ ë° ê¸°ë¡
   - ì´ˆê¸° í¬ë¡¤ë§ì€ ëª‡ ì‹œê°„ ì†Œìš”ë  ìˆ˜ ìˆìŒ

### í•„ìš”í•œ API í™œì„±í™”

ë‹¤ìŒ APIë“¤ì„ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# Discovery Engine API (Vertex AI Search)
gcloud services enable discoveryengine.googleapis.com

# Cloud Functions API
gcloud services enable cloudfunctions.googleapis.com

# Cloud Build API (ë°°í¬ì— í•„ìš”)
gcloud services enable cloudbuild.googleapis.com

# Cloud Run API (Cloud Functions Gen2 ì‚¬ìš© ì‹œ)
gcloud services enable run.googleapis.com
```

ë˜ëŠ” Google Cloud Consoleì—ì„œ ì§ì ‘ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- APIs & Services â†’ Library â†’ ê° API ê²€ìƒ‰ í›„ "Enable"

## Cloud Functions API ì„œë²„ êµ¬í˜„

### í”„ë¡œì íŠ¸ êµ¬ì¡°

```
vertex-ai-search-api/
â”œâ”€â”€ index.js           # Cloud Functions ë©”ì¸ ì½”ë“œ
â”œâ”€â”€ package.json       # Node.js ì˜ì¡´ì„±
â”œâ”€â”€ .env              # í™˜ê²½ë³€ìˆ˜ (ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš©)
â”œâ”€â”€ .env.example      # í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿
â””â”€â”€ deploy.sh         # ìë™í™” ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
```

### package.json

ë¨¼ì € í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì •ì˜í•©ë‹ˆë‹¤:

```json
{
  "name": "vertex-ai-search-api",
  "version": "1.0.0",
  "description": "Vertex AI Search API with Cloud Functions",
  "main": "index.js",
  "engines": {
    "node": "20"
  },
  "dependencies": {
    "@google-cloud/discoveryengine": "^2.0.0",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "dotenv": "^16.0.0"
  }
}
```

<strong>ì£¼ìš” ì˜ì¡´ì„±</strong>:
- `@google-cloud/discoveryengine`: Vertex AI Search API í´ë¼ì´ì–¸íŠ¸
- `cors`: Cross-Origin ìš”ì²­ ì²˜ë¦¬
- `dotenv`: ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬

### index.js - í•µì‹¬ ì½”ë“œ

Cloud Functionsì˜ ë©”ì¸ ë¡œì§ì…ë‹ˆë‹¤:

```javascript
const { SearchServiceClient } = require('@google-cloud/discoveryengine').v1alpha;
const cors = require('cors');

// CORS ì„¤ì •
const allowedDomains = (process.env.ALLOWED_DOMAINS || '').split(',').filter(Boolean);
const corsHandler = cors({
  origin: (origin, callback) => {
    // ë„ë©”ì¸ ì œí•œì´ ì—†ê±°ë‚˜, í—ˆìš©ëœ ë„ë©”ì¸ì— í¬í•¨ëœ ê²½ìš°
    if (allowedDomains.length === 0 || !origin || allowedDomains.some(domain => origin.includes(domain))) {
      callback(null, true);
    } else {
      callback(new Error('Not allowed by CORS'));
    }
  },
  credentials: true
});

// í™˜ê²½ë³€ìˆ˜ ì½ê¸°
const PROJECT_ID = process.env.PROJECT_ID;
const PROJECT_NUMBER = process.env.PROJECT_NUMBER;
const ENGINE_ID = process.env.ENGINE_ID;
const LOCATION = process.env.LOCATION || 'global';

// Discovery Engine í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
const client = new SearchServiceClient();

/**
 * Cloud Functions ì§„ì…ì 
 * HTTP ìš”ì²­ì„ ë°›ì•„ Vertex AI Search ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
 */
exports.search = async (req, res) => {
  // CORS ì²˜ë¦¬
  await new Promise((resolve, reject) => {
    corsHandler(req, res, (err) => {
      if (err) reject(err);
      else resolve();
    });
  });

  // OPTIONS ìš”ì²­ ì²˜ë¦¬ (CORS preflight)
  if (req.method === 'OPTIONS') {
    res.status(204).send('');
    return;
  }

  // GET ë˜ëŠ” POST ìš”ì²­ë§Œ í—ˆìš©
  if (req.method !== 'GET' && req.method !== 'POST') {
    res.status(405).json({ error: 'Method not allowed' });
    return;
  }

  try {
    // ê²€ìƒ‰ì–´ ì¶”ì¶œ
    const query = req.method === 'GET' ? req.query.q : req.body.query;

    if (!query || query.trim() === '') {
      res.status(400).json({ error: 'Query parameter is required' });
      return;
    }

    console.log('Search query:', query);

    // Vertex AI Search ìš”ì²­ êµ¬ì„±
    const servingConfig = `projects/${PROJECT_NUMBER}/locations/${LOCATION}/collections/default_collection/engines/${ENGINE_ID}/servingConfigs/default_config`;

    const request = {
      servingConfig,
      query,
      pageSize: 10, // ê²°ê³¼ ê°œìˆ˜
      contentSearchSpec: {
        // AI ìš”ì•½ í™œì„±í™”
        summarySpec: {
          summaryResultCount: 5, // ìš”ì•½ì— ì‚¬ìš©í•  ê²°ê³¼ ìˆ˜
          includeCitations: true, // ì¶œì²˜ í¬í•¨
          ignoreAdversarialQuery: true, // ì•…ì˜ì  ì¿¼ë¦¬ ë¬´ì‹œ
          ignoreNonSummarySeekingQuery: true, // ìš”ì•½ ë¶ˆí•„ìš” ì¿¼ë¦¬ ë¬´ì‹œ
        },
        // ìŠ¤ë‹ˆí« ì„¤ì •
        snippetSpec: {
          returnSnippet: true, // ìŠ¤ë‹ˆí« ë°˜í™˜
          maxSnippetCount: 3, // ìµœëŒ€ ìŠ¤ë‹ˆí« ìˆ˜
        },
        // ì¸ë„¤ì¼ ì„¤ì •
        extractiveContentSpec: {
          maxExtractiveSegmentCount: 3,
          maxExtractiveAnswerCount: 1,
        }
      }
    };

    // API í˜¸ì¶œ
    const [response] = await client.search(request);

    // ê²°ê³¼ ì •ì œ
    const results = response.results?.map(result => ({
      id: result.id,
      title: result.document?.structData?.title || 'Untitled',
      link: result.document?.derivedStructData?.link || result.document?.uri || '#',
      snippet: result.document?.derivedStructData?.snippets?.[0]?.snippet ||
               result.document?.derivedStructData?.extractive_segments?.[0]?.content || '',
      thumbnail: result.document?.derivedStructData?.thumbnailUri || null,
      pubDate: result.document?.structData?.pubDate || null,
      tags: result.document?.structData?.tags || []
    })) || [];

    // AI ìš”ì•½ ì¶”ì¶œ
    const summary = response.summary?.summaryText || null;
    const citations = response.summary?.summaryWithMetadata?.references?.map(ref => ({
      title: ref.title || '',
      link: ref.uri || '',
      chunkId: ref.chunkContents?.[0]?.chunkId || ''
    })) || [];

    // ì‘ë‹µ êµ¬ì„±
    const searchResponse = {
      query,
      totalResults: response.totalSize || results.length,
      results,
      summary: summary ? {
        text: summary,
        citations
      } : null,
      attribution: response.attributionToken || null
    };

    console.log(`Found ${results.length} results`);
    res.status(200).json(searchResponse);

  } catch (error) {
    console.error('Search error:', error);

    // ì¿¼í„° ì´ˆê³¼ ì—ëŸ¬ ì²˜ë¦¬
    if (error.code === 8 || error.message?.includes('Quota exceeded')) {
      res.status(429).json({
        error: 'Quota exceeded',
        message: 'ê²€ìƒ‰ í• ë‹¹ëŸ‰ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
        fallback: true
      });
      return;
    }

    // ê¸°íƒ€ ì—ëŸ¬
    res.status(500).json({
      error: 'Internal server error',
      message: error.message || 'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
    });
  }
};
```

<strong>í•µì‹¬ ê¸°ëŠ¥ ì„¤ëª…</strong>:

1. <strong>CORS ì„¤ì •</strong>
   - í™˜ê²½ë³€ìˆ˜ë¡œ í—ˆìš© ë„ë©”ì¸ ì œí•œ ê°€ëŠ¥
   - ë„ë©”ì¸ ì œí•œì´ ì—†ìœ¼ë©´ ëª¨ë“  ë„ë©”ì¸ í—ˆìš© (ê°œë°œ í™˜ê²½ìš©)

2. <strong>Discovery Engine API ì—°ë™</strong>
   - `SearchServiceClient`ë¥¼ í†µí•œ ê²€ìƒ‰ ìš”ì²­
   - `servingConfig` ê²½ë¡œ êµ¬ì„±: `projects/{number}/locations/{location}/collections/default_collection/engines/{engine_id}/servingConfigs/default_config`

3. <strong>AI ìš”ì•½ ê¸°ëŠ¥</strong>
   - `summarySpec`ì„ í†µí•´ ê²€ìƒ‰ ê²°ê³¼ ìë™ ìš”ì•½
   - ìš”ì•½ì— ì‚¬ìš©í•  ê²°ê³¼ ìˆ˜ ì§€ì • (`summaryResultCount`)
   - ì¶œì²˜ ì¸ìš© í¬í•¨ (`includeCitations`)

4. <strong>ê²€ìƒ‰ ê²°ê³¼ ì •ì œ</strong>
   - ì œëª©, ë§í¬, ìŠ¤ë‹ˆí«, ì¸ë„¤ì¼ ì¶”ì¶œ
   - ë©”íƒ€ë°ì´í„° (pubDate, tags) í¬í•¨

5. <strong>ì—ëŸ¬ ì²˜ë¦¬</strong>
   - ì¿¼í„° ì´ˆê³¼ ì‹œ 429 ìƒíƒœ ì½”ë“œ ë°˜í™˜
   - Fallback í”Œë˜ê·¸ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ëŒ€ì²´ ê²€ìƒ‰ ê°€ëŠ¥

## í™˜ê²½ë³€ìˆ˜ ì„¤ì •

### .env.example

í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿ì„ ì‘ì„±í•©ë‹ˆë‹¤:

```bash
# === í•„ìˆ˜ ì„¤ì • ===
# Google Cloud í”„ë¡œì íŠ¸ ID (ì˜ˆ: my-project)
PROJECT_ID=your-project-id

# Google Cloud í”„ë¡œì íŠ¸ ë²ˆí˜¸ (ìˆ«ì)
# Consoleì—ì„œ í™•ì¸: Home â†’ Dashboard â†’ Project Info
PROJECT_NUMBER=123456789012

# Vertex AI Search Engine ID
# Agent Builderì—ì„œ ìƒì„±í•œ ì—”ì§„ì˜ ID
ENGINE_ID=your-engine-id

# === ì„ íƒ ì„¤ì • ===
# ê²€ìƒ‰ ì—”ì§„ ìœ„ì¹˜ (ê¸°ë³¸ê°’: global)
LOCATION=global

# CORS í—ˆìš© ë„ë©”ì¸ (ì‰¼í‘œë¡œ êµ¬ë¶„, ë¹„ì–´ìˆìœ¼ë©´ ëª¨ë“  ë„ë©”ì¸ í—ˆìš©)
ALLOWED_DOMAINS=yourdomain.com,www.yourdomain.com

# === ë°°í¬ ì„¤ì • ===
# Cloud Functions ë°°í¬ ë¦¬ì „
REGION=asia-northeast1

# ë©”ëª¨ë¦¬ í• ë‹¹ (MB)
MEMORY=256MB

# íƒ€ì„ì•„ì›ƒ (ì´ˆ)
TIMEOUT=60

# ìµœëŒ€ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜
MAX_INSTANCES=10
```

### í™˜ê²½ë³€ìˆ˜ í™•ì¸ ë°©ë²•

<strong>í”„ë¡œì íŠ¸ ë²ˆí˜¸ í™•ì¸</strong>:

```bash
# gcloud ëª…ë ¹ì–´ë¡œ í™•ì¸
gcloud projects describe YOUR_PROJECT_ID --format="value(projectNumber)"

# ë˜ëŠ” Cloud Consoleì—ì„œ:
# Home â†’ Dashboard â†’ Project Info â†’ Project number
```

<strong>Engine ID í™•ì¸</strong>:

```bash
# Agent Builder ì½˜ì†”ì—ì„œ:
# Agent Builder â†’ Apps â†’ ìƒì„±í•œ ì•± ì„ íƒ â†’ Details íƒ­ â†’ ID í™•ì¸

# ë˜ëŠ” gcloud ëª…ë ¹ì–´ë¡œ í™•ì¸
gcloud discovery-engine engines list \
  --project=YOUR_PROJECT_ID \
  --location=global
```

## ìë™í™”ëœ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ (deploy.sh)

ì´ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ì€ <strong>ë°°í¬ ìë™í™”</strong>ì…ë‹ˆë‹¤. ì…¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ ë°°í¬ ê³¼ì •ì„ ë‹¨ìˆœí™”í•©ë‹ˆë‹¤.

### deploy.sh ì „ì²´ ì½”ë“œ

```bash
#!/bin/bash

# ìƒ‰ìƒ ì •ì˜
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# ê¸°ë³¸ê°’
ENV_FILE=".env"
DRY_RUN=false

# ë„ì›€ë§ ì¶œë ¥
show_help() {
  cat << EOF
Vertex AI Search Cloud Functions ë°°í¬ ìŠ¤í¬ë¦½íŠ¸

ì‚¬ìš©ë²•:
  ./deploy.sh [ì˜µì…˜]

ì˜µì…˜:
  --env-file FILE    í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ê²½ë¡œ (ê¸°ë³¸ê°’: .env)
  --dry-run          ì‹¤ì œ ë°°í¬í•˜ì§€ ì•Šê³  ëª…ë ¹ì–´ë§Œ ì¶œë ¥
  -h, --help         ë„ì›€ë§ í‘œì‹œ

ì˜ˆì‹œ:
  ./deploy.sh                          # .env íŒŒì¼ ì‚¬ìš©í•˜ì—¬ ë°°í¬
  ./deploy.sh --env-file .env.prod     # í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬
  ./deploy.sh --dry-run                # ë°°í¬ ëª…ë ¹ì–´ í™•ì¸ë§Œ
EOF
}

# ì¸ì íŒŒì‹±
while [[ $# -gt 0 ]]; do
  case $1 in
    --env-file)
      ENV_FILE="$2"
      shift 2
      ;;
    --dry-run)
      DRY_RUN=true
      shift
      ;;
    -h|--help)
      show_help
      exit 0
      ;;
    *)
      echo -e "${RED}ì•Œ ìˆ˜ ì—†ëŠ” ì˜µì…˜: $1${NC}"
      show_help
      exit 1
      ;;
  esac
done

# í™˜ê²½ë³€ìˆ˜ íŒŒì¼ í™•ì¸
if [ ! -f "$ENV_FILE" ]; then
  echo -e "${RED}í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: $ENV_FILE${NC}"
  echo ""
  echo "ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í…œí”Œë¦¿ì„ ìƒì„±í•˜ì„¸ìš”:"
  echo "  cp .env.example $ENV_FILE"
  exit 1
fi

echo -e "${BLUE}=== Vertex AI Search Cloud Functions ë°°í¬ ===${NC}"
echo ""

# .env íŒŒì¼ ì½ê¸° ë° íŒŒì‹±
echo -e "${YELLOW}í™˜ê²½ë³€ìˆ˜ ë¡œë“œ ì¤‘... ($ENV_FILE)${NC}"
set -a
source "$ENV_FILE"
set +a

# í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ í™•ì¸
REQUIRED_VARS=("PROJECT_ID" "PROJECT_NUMBER" "ENGINE_ID")
MISSING_VARS=()

for var in "${REQUIRED_VARS[@]}"; do
  if [ -z "${!var}" ]; then
    MISSING_VARS+=("$var")
  fi
done

if [ ${#MISSING_VARS[@]} -gt 0 ]; then
  echo -e "${RED}í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤:${NC}"
  for var in "${MISSING_VARS[@]}"; do
    echo "  - $var"
  done
  exit 1
fi

# ê¸°ë³¸ê°’ ì„¤ì •
LOCATION=${LOCATION:-global}
REGION=${REGION:-asia-northeast1}
MEMORY=${MEMORY:-256MB}
TIMEOUT=${TIMEOUT:-60}
MAX_INSTANCES=${MAX_INSTANCES:-10}
FUNCTION_NAME=${FUNCTION_NAME:-vertex-ai-search}

echo -e "${GREEN}âœ“ í™˜ê²½ë³€ìˆ˜ ë¡œë“œ ì™„ë£Œ${NC}"
echo ""

# í˜„ì¬ ì„¤ì • ì¶œë ¥
echo -e "${BLUE}ë°°í¬ ì„¤ì •:${NC}"
echo "  Project ID: $PROJECT_ID"
echo "  Project Number: $PROJECT_NUMBER"
echo "  Engine ID: $ENGINE_ID"
echo "  Location: $LOCATION"
echo "  Region: $REGION"
echo "  Function Name: $FUNCTION_NAME"
echo "  Memory: $MEMORY"
echo "  Timeout: ${TIMEOUT}s"
echo "  Max Instances: $MAX_INSTANCES"
echo ""

# gcloud í”„ë¡œì íŠ¸ í™•ì¸
CURRENT_PROJECT=$(gcloud config get-value project 2>/dev/null)

if [ "$CURRENT_PROJECT" != "$PROJECT_ID" ]; then
  echo -e "${YELLOW}í˜„ì¬ gcloud í”„ë¡œì íŠ¸: $CURRENT_PROJECT${NC}"
  echo -e "${YELLOW}ë°°í¬ ëŒ€ìƒ í”„ë¡œì íŠ¸: $PROJECT_ID${NC}"
  echo ""

  if [ "$DRY_RUN" = false ]; then
    read -p "í”„ë¡œì íŠ¸ë¥¼ ì „í™˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): " -n 1 -r
    echo

    if [[ $REPLY =~ ^[Yy]$ ]]; then
      echo -e "${YELLOW}í”„ë¡œì íŠ¸ ì „í™˜ ì¤‘...${NC}"
      gcloud config set project "$PROJECT_ID"
      echo -e "${GREEN}âœ“ í”„ë¡œì íŠ¸ ì „í™˜ ì™„ë£Œ${NC}"
    else
      echo -e "${RED}ë°°í¬ë¥¼ ì·¨ì†Œí•©ë‹ˆë‹¤.${NC}"
      exit 1
    fi
  else
    echo -e "${BLUE}[DRY RUN] gcloud config set project $PROJECT_ID${NC}"
  fi
fi

# í•„ìš”í•œ API í™œì„±í™” í™•ì¸
echo ""
echo -e "${YELLOW}í•„ìš”í•œ API í™œì„±í™” í™•ì¸ ì¤‘...${NC}"

REQUIRED_APIS=(
  "discoveryengine.googleapis.com"
  "cloudfunctions.googleapis.com"
  "cloudbuild.googleapis.com"
  "run.googleapis.com"
)

for api in "${REQUIRED_APIS[@]}"; do
  if gcloud services list --enabled --filter="name:$api" --format="value(name)" | grep -q "$api"; then
    echo -e "${GREEN}âœ“ $api${NC}"
  else
    echo -e "${YELLOW}âš  $api (ë¹„í™œì„±í™”)${NC}"

    if [ "$DRY_RUN" = false ]; then
      echo "  í™œì„±í™” ì¤‘..."
      gcloud services enable "$api"
      echo -e "${GREEN}  âœ“ í™œì„±í™” ì™„ë£Œ${NC}"
    else
      echo -e "${BLUE}  [DRY RUN] gcloud services enable $api${NC}"
    fi
  fi
done

# Cloud Functions ë°°í¬
echo ""
echo -e "${YELLOW}Cloud Functions ë°°í¬ ì¤‘...${NC}"

DEPLOY_CMD="gcloud functions deploy $FUNCTION_NAME \
  --gen2 \
  --runtime=nodejs20 \
  --region=$REGION \
  --source=. \
  --entry-point=search \
  --trigger-http \
  --allow-unauthenticated \
  --memory=$MEMORY \
  --timeout=$TIMEOUT \
  --max-instances=$MAX_INSTANCES \
  --set-env-vars=PROJECT_ID=$PROJECT_ID,PROJECT_NUMBER=$PROJECT_NUMBER,ENGINE_ID=$ENGINE_ID,LOCATION=$LOCATION,ALLOWED_DOMAINS=$ALLOWED_DOMAINS"

if [ "$DRY_RUN" = true ]; then
  echo -e "${BLUE}[DRY RUN] ë°°í¬ ëª…ë ¹ì–´:${NC}"
  echo "$DEPLOY_CMD"
else
  eval "$DEPLOY_CMD"

  if [ $? -eq 0 ]; then
    echo ""
    echo -e "${GREEN}âœ“ ë°°í¬ ì™„ë£Œ!${NC}"
    echo ""

    # ì—”ë“œí¬ì¸íŠ¸ URL ì¡°íšŒ ë° ì €ì¥
    FUNCTION_URL=$(gcloud functions describe $FUNCTION_NAME \
      --gen2 \
      --region=$REGION \
      --format="value(serviceConfig.uri)")

    echo -e "${GREEN}í•¨ìˆ˜ URL:${NC}"
    echo "  $FUNCTION_URL"

    # .env.deployed íŒŒì¼ì— URL ì €ì¥
    echo "FUNCTION_URL=$FUNCTION_URL" > .env.deployed
    echo ""
    echo -e "${GREEN}URLì´ .env.deployed íŒŒì¼ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.${NC}"

    # í…ŒìŠ¤íŠ¸ HTML ìƒì„±
    echo ""
    echo -e "${YELLOW}í…ŒìŠ¤íŠ¸ HTML íŒŒì¼ ìƒì„± ì¤‘...${NC}"

    cat > test.html << EOF
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertex AI Search Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1a73e8;
            margin-bottom: 20px;
        }
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        input[type="text"] {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            padding: 12px 24px;
            background: #1a73e8;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #1557b0;
        }
        .loading {
            text-align: center;
            color: #666;
            padding: 20px;
        }
        .error {
            background: #fee;
            color: #c00;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .summary {
            background: #e8f0fe;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #1a73e8;
        }
        .summary h3 {
            margin-top: 0;
            color: #1a73e8;
        }
        .result {
            border-bottom: 1px solid #e0e0e0;
            padding: 15px 0;
        }
        .result:last-child {
            border-bottom: none;
        }
        .result h3 {
            margin: 0 0 8px 0;
        }
        .result a {
            color: #1a73e8;
            text-decoration: none;
        }
        .result a:hover {
            text-decoration: underline;
        }
        .snippet {
            color: #666;
            line-height: 1.6;
        }
        .tags {
            margin-top: 8px;
        }
        .tag {
            display: inline-block;
            background: #e8f0fe;
            color: #1a73e8;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Vertex AI Search Test</h1>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
            <button onclick="search()">ê²€ìƒ‰</button>
        </div>

        <div id="results"></div>
    </div>

    <script>
        const API_URL = '$FUNCTION_URL';

        async function search() {
            const query = document.getElementById('searchInput').value.trim();
            const resultsDiv = document.getElementById('results');

            if (!query) {
                resultsDiv.innerHTML = '<div class="error">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>';
                return;
            }

            resultsDiv.innerHTML = '<div class="loading">ê²€ìƒ‰ ì¤‘...</div>';

            try {
                const response = await fetch(\`\${API_URL}?q=\${encodeURIComponent(query)}\`);
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }

                displayResults(data);
            } catch (error) {
                resultsDiv.innerHTML = \`<div class="error">\${error.message}</div>\`;
            }
        }

        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            let html = '';

            // AI ìš”ì•½ í‘œì‹œ
            if (data.summary) {
                html += \`
                    <div class="summary">
                        <h3>ğŸ“ AI ìš”ì•½</h3>
                        <p>\${data.summary.text}</p>
                    </div>
                \`;
            }

            // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
            if (data.results && data.results.length > 0) {
                html += \`<p><strong>ì´ \${data.totalResults}ê°œì˜ ê²°ê³¼</strong></p>\`;

                data.results.forEach(result => {
                    html += \`
                        <div class="result">
                            <h3><a href="\${result.link}" target="_blank">\${result.title}</a></h3>
                            <p class="snippet">\${result.snippet}</p>
                            \${result.tags && result.tags.length > 0 ? \`
                                <div class="tags">
                                    \${result.tags.map(tag => \`<span class="tag">\${tag}</span>\`).join('')}
                                </div>
                            \` : ''}
                        </div>
                    \`;
                });
            } else {
                html += '<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            }

            resultsDiv.innerHTML = html;
        }

        // ì—”í„°í‚¤ë¡œ ê²€ìƒ‰
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                search();
            }
        });
    </script>
</body>
</html>
EOF

    echo -e "${GREEN}âœ“ test.html íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.${NC}"
    echo ""
    echo -e "${BLUE}í…ŒìŠ¤íŠ¸ ë°©ë²•:${NC}"
    echo "  1. test.html íŒŒì¼ì„ ë¸Œë¼ìš°ì €ë¡œ ì—´ê¸°"
    echo "  2. ê²€ìƒ‰ì–´ ì…ë ¥ í›„ ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­"
    echo ""

  else
    echo ""
    echo -e "${RED}âœ— ë°°í¬ ì‹¤íŒ¨${NC}"
    exit 1
  fi
fi
```

### ìŠ¤í¬ë¦½íŠ¸ì˜ ì£¼ìš” ê¸°ëŠ¥

1. <strong>.env íŒŒì¼ ì½ê¸° ë° íŒŒì‹±</strong>
   - `source` ëª…ë ¹ì–´ë¡œ í™˜ê²½ë³€ìˆ˜ ë¡œë“œ
   - í•„ìˆ˜ ë³€ìˆ˜ ëˆ„ë½ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ ì¶œë ¥

2. <strong>gcloud í”„ë¡œì íŠ¸ ìë™ í™•ì¸/ì „í™˜</strong>
   - í˜„ì¬ ì„¤ì •ëœ í”„ë¡œì íŠ¸ì™€ ë°°í¬ ëŒ€ìƒ í”„ë¡œì íŠ¸ ë¹„êµ
   - ë‹¤ë¥´ë©´ ì‚¬ìš©ìì—ê²Œ í™•ì¸ í›„ ìë™ ì „í™˜

3. <strong>í•„ìš”í•œ API ìë™ í™œì„±í™”</strong>
   - Discovery Engine, Cloud Functions, Cloud Build, Cloud Run API
   - ë¹„í™œì„±í™” ìƒíƒœë©´ ìë™ìœ¼ë¡œ í™œì„±í™”

4. <strong>Cloud Functions ë°°í¬</strong>
   - Gen2 í•¨ìˆ˜ ì‚¬ìš© (ë” ë¹ ë¥´ê³  ê°•ë ¥í•¨)
   - í™˜ê²½ë³€ìˆ˜ ìë™ ì„¤ì •
   - ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì • (`--allow-unauthenticated`)

5. <strong>ì—”ë“œí¬ì¸íŠ¸ URL ìë™ ì €ì¥</strong>
   - ë°°í¬ ì™„ë£Œ í›„ í•¨ìˆ˜ URL ì¡°íšŒ
   - `.env.deployed` íŒŒì¼ì— ì €ì¥í•˜ì—¬ ì¬ì‚¬ìš© ê°€ëŠ¥

6. <strong>í…ŒìŠ¤íŠ¸ HTML ìë™ ìƒì„±</strong>
   - ë°°í¬ëœ APIë¥¼ ë°”ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” HTML íŒŒì¼ ìƒì„±
   - API URLì´ ìë™ìœ¼ë¡œ í¬í•¨ë¨

### ì‚¬ìš©ë²•

<strong>ê¸°ë³¸ ë°°í¬</strong>:

```bash
# .env íŒŒì¼ ìƒì„±
cp .env.example .env
# .env íŒŒì¼ ìˆ˜ì • (PROJECT_ID, PROJECT_NUMBER, ENGINE_ID ì„¤ì •)

# ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x deploy.sh

# ë°°í¬ ì‹¤í–‰
./deploy.sh
```

<strong>ë‹¤ì–‘í•œ ì˜µì…˜</strong>:

```bash
# í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬
./deploy.sh --env-file .env.production

# Staging í™˜ê²½ ë°°í¬
./deploy.sh --env-file .env.staging

# ë°°í¬ ëª…ë ¹ì–´ë§Œ í™•ì¸ (ì‹¤ì œ ë°°í¬ ì•ˆ í•¨)
./deploy.sh --dry-run

# ë„ì›€ë§ í™•ì¸
./deploy.sh --help
```

### ë‹¤ì¤‘ í™˜ê²½ ê´€ë¦¬

ì—¬ëŸ¬ í™˜ê²½ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ í™˜ê²½ë³„ .env íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```
.env.development   # ê°œë°œ í™˜ê²½
.env.staging       # ìŠ¤í…Œì´ì§• í™˜ê²½
.env.production    # í”„ë¡œë•ì…˜ í™˜ê²½
```

ê° í™˜ê²½ë³„ë¡œ ë‹¤ë¥¸ ì„¤ì •ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# .env.development
PROJECT_ID=my-project-dev
ENGINE_ID=dev-engine-id
ALLOWED_DOMAINS=localhost,127.0.0.1
REGION=asia-northeast1
MAX_INSTANCES=2

# .env.production
PROJECT_ID=my-project-prod
ENGINE_ID=prod-engine-id
ALLOWED_DOMAINS=yourdomain.com,www.yourdomain.com
REGION=asia-northeast1
MAX_INSTANCES=10
```

## í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™

### ê¸°ë³¸ ê²€ìƒ‰ êµ¬í˜„

Cloud Functions APIë¥¼ í˜¸ì¶œí•˜ëŠ” JavaScript ì½”ë“œì…ë‹ˆë‹¤:

```javascript
// ê²€ìƒ‰ í•¨ìˆ˜
async function searchSite(query) {
  const API_URL = 'https://YOUR_REGION-YOUR_PROJECT_ID.cloudfunctions.net/vertex-ai-search';

  try {
    const response = await fetch(`${API_URL}?q=${encodeURIComponent(query)}`);

    if (!response.ok) {
      throw new Error('ê²€ìƒ‰ ì‹¤íŒ¨');
    }

    const data = await response.json();
    return data;

  } catch (error) {
    console.error('ê²€ìƒ‰ ì˜¤ë¥˜:', error);
    throw error;
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
searchSite('Vertex AI')
  .then(data => {
    console.log('ê²€ìƒ‰ ê²°ê³¼:', data);
    displayResults(data);
  })
  .catch(error => {
    console.error('ì˜¤ë¥˜:', error);
  });
```

### ê²€ìƒ‰ UI ì»´í¬ë„ŒíŠ¸

React/Vue/Vanilla JS ë“±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²€ìƒ‰ UI ì˜ˆì‹œì…ë‹ˆë‹¤:

```javascript
// ê²€ìƒ‰ ê²°ê³¼ ë Œë”ë§
function displayResults(data) {
  const container = document.getElementById('search-results');

  // ê²°ê³¼ê°€ ì—†ëŠ” ê²½ìš°
  if (!data.results || data.results.length === 0) {
    container.innerHTML = '<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
    return;
  }

  let html = '';

  // AI ìš”ì•½ í‘œì‹œ (ìˆëŠ” ê²½ìš°)
  if (data.summary) {
    html += `
      <div class="search-summary">
        <h3>ğŸ“ AI ìš”ì•½</h3>
        <p>${data.summary.text}</p>

        ${data.summary.citations.length > 0 ? `
          <div class="citations">
            <strong>ì¶œì²˜:</strong>
            <ul>
              ${data.summary.citations.map(citation => `
                <li><a href="${citation.link}" target="_blank">${citation.title}</a></li>
              `).join('')}
            </ul>
          </div>
        ` : ''}
      </div>
    `;
  }

  // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡
  html += `<p class="total-results">ì´ ${data.totalResults}ê°œì˜ ê²°ê³¼</p>`;

  data.results.forEach(result => {
    html += `
      <article class="search-result">
        <h3>
          <a href="${result.link}" target="_blank">${result.title}</a>
        </h3>

        ${result.snippet ? `
          <p class="snippet">${result.snippet}</p>
        ` : ''}

        ${result.tags && result.tags.length > 0 ? `
          <div class="tags">
            ${result.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
          </div>
        ` : ''}

        ${result.pubDate ? `
          <time class="pub-date">${new Date(result.pubDate).toLocaleDateString('ko-KR')}</time>
        ` : ''}
      </article>
    `;
  });

  container.innerHTML = html;
}
```

### Astro í†µí•© ì˜ˆì‹œ

Astro í”„ë ˆì„ì›Œí¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤:

```astro
---
// src/components/Search.astro
---

<div class="search-container">
  <input
    type="text"
    id="search-input"
    placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
    aria-label="ì‚¬ì´íŠ¸ ê²€ìƒ‰"
  />
  <button id="search-button">ê²€ìƒ‰</button>

  <div id="search-results"></div>
</div>

<style>
  .search-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
  }

  #search-input {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    border: 2px solid #e0e0e0;
    border-radius: 4px;
  }

  #search-button {
    margin-top: 10px;
    padding: 12px 24px;
    background: #1a73e8;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  .search-summary {
    background: #e8f0fe;
    padding: 20px;
    border-radius: 8px;
    margin: 20px 0;
    border-left: 4px solid #1a73e8;
  }

  .search-result {
    border-bottom: 1px solid #e0e0e0;
    padding: 20px 0;
  }

  .search-result h3 {
    margin: 0 0 10px 0;
  }

  .search-result a {
    color: #1a73e8;
    text-decoration: none;
  }

  .snippet {
    color: #666;
    line-height: 1.6;
  }

  .tags {
    margin-top: 10px;
  }

  .tag {
    display: inline-block;
    background: #e8f0fe;
    color: #1a73e8;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    margin-right: 8px;
  }
</style>

<script>
  const API_URL = import.meta.env.PUBLIC_SEARCH_API_URL;

  const searchInput = document.getElementById('search-input') as HTMLInputElement;
  const searchButton = document.getElementById('search-button') as HTMLButtonElement;
  const resultsContainer = document.getElementById('search-results') as HTMLDivElement;

  async function performSearch() {
    const query = searchInput.value.trim();

    if (!query) {
      resultsContainer.innerHTML = '<p>ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>';
      return;
    }

    resultsContainer.innerHTML = '<p>ê²€ìƒ‰ ì¤‘...</p>';

    try {
      const response = await fetch(`${API_URL}?q=${encodeURIComponent(query)}`);
      const data = await response.json();

      if (!response.ok) {
        throw new Error(data.message || 'ê²€ìƒ‰ ì‹¤íŒ¨');
      }

      displayResults(data);

    } catch (error) {
      resultsContainer.innerHTML = `<p class="error">ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`;
    }
  }

  function displayResults(data: any) {
    // ìœ„ì˜ displayResults í•¨ìˆ˜ ë‚´ìš©ê³¼ ë™ì¼
  }

  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
  searchButton?.addEventListener('click', performSearch);
  searchInput?.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      performSearch();
    }
  });
</script>
```

### í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env)

Astro í”„ë¡œì íŠ¸ì˜ `.env` íŒŒì¼ì— API URLì„ ì¶”ê°€í•©ë‹ˆë‹¤:

```bash
# Public variables (í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥)
PUBLIC_SEARCH_API_URL=https://YOUR_REGION-YOUR_PROJECT_ID.cloudfunctions.net/vertex-ai-search
```

## ê²€ìƒ‰ ì„±ëŠ¥ ìµœì í™”

### ë””ë°”ìš´ì‹± (Debouncing)

ì‚¬ìš©ìê°€ ì…ë ¥í•  ë•Œë§ˆë‹¤ ê²€ìƒ‰í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ì—¬ API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì…ë‹ˆë‹¤:

```javascript
// ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// ì‚¬ìš© ì˜ˆì‹œ
const debouncedSearch = debounce(performSearch, 300);

searchInput.addEventListener('input', () => {
  debouncedSearch();
});
```

### ê²°ê³¼ ìºì‹±

ë™ì¼í•œ ê²€ìƒ‰ì–´ì— ëŒ€í•´ ë°˜ë³µ ìš”ì²­ì„ ë°©ì§€í•©ë‹ˆë‹¤:

```javascript
// ê°„ë‹¨í•œ ì¸ë©”ëª¨ë¦¬ ìºì‹œ
const searchCache = new Map();
const CACHE_TTL = 5 * 60 * 1000; // 5ë¶„

async function searchWithCache(query) {
  const cached = searchCache.get(query);

  // ìºì‹œê°€ ìˆê³  ìœ íš¨ê¸°ê°„ ë‚´ë¼ë©´ ìºì‹œ ë°˜í™˜
  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {
    console.log('ìºì‹œì—ì„œ ê²°ê³¼ ë°˜í™˜:', query);
    return cached.data;
  }

  // API í˜¸ì¶œ
  const data = await searchSite(query);

  // ìºì‹œ ì €ì¥
  searchCache.set(query, {
    data,
    timestamp: Date.now()
  });

  // ìºì‹œ í¬ê¸° ì œí•œ (ìµœëŒ€ 50ê°œ)
  if (searchCache.size > 50) {
    const firstKey = searchCache.keys().next().value;
    searchCache.delete(firstKey);
  }

  return data;
}
```

### ë¡œë”© ìƒíƒœ ê´€ë¦¬

ì‚¬ìš©ì ê²½í—˜ í–¥ìƒì„ ìœ„í•œ ë¡œë”© ì¸ë””ì¼€ì´í„°:

```javascript
function showLoading() {
  resultsContainer.innerHTML = `
    <div class="loading">
      <div class="spinner"></div>
      <p>ê²€ìƒ‰ ì¤‘...</p>
    </div>
  `;
}

function hideLoading() {
  const loading = resultsContainer.querySelector('.loading');
  if (loading) {
    loading.remove();
  }
}

async function performSearch() {
  showLoading();

  try {
    const data = await searchWithCache(query);
    displayResults(data);
  } catch (error) {
    // ì—ëŸ¬ ì²˜ë¦¬
  } finally {
    hideLoading();
  }
}
```

CSS ìŠ¤í”¼ë„ˆ:

```css
.loading {
  text-align: center;
  padding: 40px;
}

.spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #1a73e8;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```

## ë¹„ìš© ìµœì í™”

### ë¹„ìš© êµ¬ì¡° ì´í•´

Vertex AI Searchì˜ ì£¼ìš” ë¹„ìš© ìš”ì†Œ:

1. <strong>ì¸ë±ì‹± ë¹„ìš©</strong>
   - ì›¹ì‚¬ì´íŠ¸ í¬ë¡¤ë§ ë° ì¸ë±ì‹±
   - ë¬¸ì„œ ê°œìˆ˜ì™€ í¬ê¸°ì— ë¹„ë¡€

2. <strong>ì¿¼ë¦¬ ë¹„ìš©</strong>
   - ê²€ìƒ‰ ìš”ì²­ë‹¹ ê³¼ê¸ˆ
   - AI ìš”ì•½ ì‚¬ìš© ì‹œ ì¶”ê°€ ë¹„ìš©

3. <strong>Cloud Functions ë¹„ìš©</strong>
   - í•¨ìˆ˜ í˜¸ì¶œ íšŸìˆ˜
   - ì‹¤í–‰ ì‹œê°„ ë° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

### ë¹„ìš© ì ˆê° ì „ëµ

<strong>1. ê²€ìƒ‰ ì¿¼ë¦¬ ìµœì†Œí™”</strong>

```javascript
// ë„ˆë¬´ ì§§ì€ ê²€ìƒ‰ì–´ëŠ” ë§‰ê¸° (ë…¸ì´ì¦ˆ ë°©ì§€)
function performSearch() {
  const query = searchInput.value.trim();

  if (query.length < 2) {
    resultsContainer.innerHTML = '<p>ìµœì†Œ 2ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>';
    return;
  }

  // ê²€ìƒ‰ ì‹¤í–‰...
}
```

<strong>2. ìºì‹± ì ê·¹ í™œìš©</strong>

```javascript
// LocalStorageë¥¼ ì´ìš©í•œ ì˜êµ¬ ìºì‹œ
const CACHE_KEY = 'search_cache';
const CACHE_VERSION = 'v1';

function getCachedResults(query) {
  try {
    const cache = JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');

    if (cache.version !== CACHE_VERSION) {
      localStorage.removeItem(CACHE_KEY);
      return null;
    }

    const cached = cache.data?.[query];

    if (cached && Date.now() - cached.timestamp < CACHE_TTL) {
      return cached.results;
    }

  } catch (e) {
    console.error('ìºì‹œ ì½ê¸° ì‹¤íŒ¨:', e);
  }

  return null;
}

function setCachedResults(query, results) {
  try {
    const cache = JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');

    cache.version = CACHE_VERSION;
    cache.data = cache.data || {};
    cache.data[query] = {
      results,
      timestamp: Date.now()
    };

    localStorage.setItem(CACHE_KEY, JSON.stringify(cache));

  } catch (e) {
    console.error('ìºì‹œ ì €ì¥ ì‹¤íŒ¨:', e);
  }
}
```

<strong>3. Cloud Functions ë©”ëª¨ë¦¬ ìµœì í™”</strong>

```bash
# .env íŒŒì¼ì—ì„œ ë©”ëª¨ë¦¬ ì¡°ì •
MEMORY=256MB    # ê¸°ë³¸ê°’ (ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì¶©ë¶„)
MEMORY=128MB    # ìµœì†Œê°’ (ë¹„ìš© ì ˆê°, íŠ¸ë˜í”½ ì ì„ ë•Œ)
MEMORY=512MB    # ë†’ì€ íŠ¸ë˜í”½ ì‹œ ì„±ëŠ¥ í–¥ìƒ
```

<strong>4. ìš”ì•½ ê¸°ëŠ¥ ì„ íƒì  ì‚¬ìš©</strong>

```javascript
// ìš”ì•½ì´ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ìš”ì²­
async function searchSite(query, includeSummary = false) {
  const url = new URL(API_URL);
  url.searchParams.set('q', query);

  if (includeSummary) {
    url.searchParams.set('summary', 'true');
  }

  const response = await fetch(url);
  return response.json();
}

// ì‚¬ìš©
searchSite('Vertex AI', true);  // ìš”ì•½ í¬í•¨
searchSite('Vertex AI', false); // ìš”ì•½ ì œì™¸ (ë¹„ìš© ì ˆê°)
```

## ëª¨ë‹ˆí„°ë§ ë° ë””ë²„ê¹…

### Cloud Functions ë¡œê·¸ í™•ì¸

```bash
# ìµœê·¼ ë¡œê·¸ í™•ì¸
gcloud functions logs read vertex-ai-search \
  --gen2 \
  --region=asia-northeast1 \
  --limit=50

# ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
gcloud functions logs read vertex-ai-search \
  --gen2 \
  --region=asia-northeast1 \
  --limit=50 \
  --format="table(time, message)"
```

### ì—ëŸ¬ ì¶”ì 

Cloud Functions ì½”ë“œì— ìƒì„¸í•œ ë¡œê¹… ì¶”ê°€:

```javascript
exports.search = async (req, res) => {
  const startTime = Date.now();

  try {
    const query = req.query.q || req.body.query;

    console.log('Search request:', {
      query,
      method: req.method,
      userAgent: req.get('user-agent'),
      referer: req.get('referer')
    });

    // ê²€ìƒ‰ ì‹¤í–‰...
    const [response] = await client.search(request);

    console.log('Search completed:', {
      query,
      resultsCount: response.results?.length || 0,
      duration: Date.now() - startTime,
      hasSummary: !!response.summary
    });

    res.status(200).json(searchResponse);

  } catch (error) {
    console.error('Search error:', {
      query: req.query.q || req.body.query,
      error: error.message,
      code: error.code,
      stack: error.stack,
      duration: Date.now() - startTime
    });

    res.status(500).json({ error: error.message });
  }
};
```

### ì„±ëŠ¥ ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§

Google Cloud Consoleì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ë©”íŠ¸ë¦­:

- <strong>Cloud Functions</strong>:
  - í˜¸ì¶œ íšŸìˆ˜
  - í‰ê·  ì‹¤í–‰ ì‹œê°„
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
  - ì˜¤ë¥˜ìœ¨

- <strong>Vertex AI Search</strong>:
  - ê²€ìƒ‰ ì¿¼ë¦¬ ìˆ˜
  - í‰ê·  ì‘ë‹µ ì‹œê°„
  - ì¸ë±ì‹±ëœ ë¬¸ì„œ ìˆ˜
  - AI ìš”ì•½ ì‚¬ìš© íšŸìˆ˜

### ì•Œë¦¼ ì„¤ì •

Cloud Monitoringì„ í†µí•œ ì•Œë¦¼ ì„¤ì •:

```bash
# ì˜¤ë¥˜ìœ¨ì´ 5%ë¥¼ ì´ˆê³¼í•˜ë©´ ì•Œë¦¼
gcloud alpha monitoring policies create \
  --notification-channels=CHANNEL_ID \
  --display-name="Search Function Error Rate" \
  --condition-display-name="Error rate > 5%" \
  --condition-threshold-value=0.05 \
  --condition-threshold-duration=300s
```

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ

<strong>1. CORS ì˜¤ë¥˜</strong>

```
Access to fetch at 'https://...' from origin 'https://yourdomain.com'
has been blocked by CORS policy
```

í•´ê²°:

```bash
# .env íŒŒì¼ì—ì„œ ë„ë©”ì¸ ì¶”ê°€
ALLOWED_DOMAINS=yourdomain.com,www.yourdomain.com,localhost

# ì¬ë°°í¬
./deploy.sh
```

<strong>2. ê²€ìƒ‰ ê²°ê³¼ê°€ ë¹„ì–´ìˆìŒ</strong>

ì›ì¸:
- í¬ë¡¤ë§ì´ ì•„ì§ ì™„ë£Œë˜ì§€ ì•ŠìŒ
- ì›¹ì‚¬ì´íŠ¸ì— robots.txtë¡œ í¬ë¡¤ë§ ì°¨ë‹¨

í•´ê²°:

```bash
# Agent Builder ì½˜ì†”ì—ì„œ í¬ë¡¤ë§ ìƒíƒœ í™•ì¸
# Console â†’ Agent Builder â†’ ì•± ì„ íƒ â†’ Data â†’ Status

# robots.txt í™•ì¸
curl https://yourdomain.com/robots.txt

# ìˆ˜ë™ìœ¼ë¡œ ì¬í¬ë¡¤ë§ íŠ¸ë¦¬ê±°
# Console â†’ Agent Builder â†’ ì•± ì„ íƒ â†’ Data â†’ Refresh
```

<strong>3. API ì¿¼í„° ì´ˆê³¼</strong>

```json
{
  "error": "Quota exceeded",
  "message": "ê²€ìƒ‰ í• ë‹¹ëŸ‰ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤."
}
```

í•´ê²°:

```bash
# í˜„ì¬ ì¿¼í„° í™•ì¸
gcloud services quota list \
  --service=discoveryengine.googleapis.com \
  --consumer=projects/YOUR_PROJECT_ID

# ì¿¼í„° ì¦ê°€ ìš”ì²­
# Console â†’ IAM & Admin â†’ Quotas â†’ Discovery Engine API â†’ Edit Quotas
```

<strong>4. Cloud Functions ë°°í¬ ì‹¤íŒ¨</strong>

```
ERROR: (gcloud.functions.deploy) OperationError: code=3, message=Build failed
```

í•´ê²°:

```bash
# package.jsonì˜ Node.js ë²„ì „ í™•ì¸
# "engines": { "node": "20" }

# ë¡œì»¬ì—ì„œ ì˜ì¡´ì„± í…ŒìŠ¤íŠ¸
npm install
npm test

# ë¹Œë“œ ë¡œê·¸ í™•ì¸
gcloud functions logs read vertex-ai-search \
  --gen2 \
  --region=asia-northeast1 \
  --limit=100
```

## ê²°ë¡  ë° ë‹¤ìŒ ë‹¨ê³„

### í•µì‹¬ ìš”ì•½

ì´ ê¸€ì—ì„œ êµ¬í˜„í•œ ì‹œìŠ¤í…œì˜ ì£¼ìš” ì¥ì :

âœ… <strong>ì™„ì „ ê´€ë¦¬í˜•</strong>: ì¸í”„ë¼ ê´€ë¦¬ ë¶ˆí•„ìš”, Googleì´ ëª¨ë“  ê²ƒì„ ì²˜ë¦¬
âœ… <strong>ìë™í™”ëœ ë°°í¬</strong>: ì…¸ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì›í´ë¦­ ë°°í¬
âœ… <strong>AI ê¸°ë°˜ ê²€ìƒ‰</strong>: í‚¤ì›Œë“œ ë§¤ì¹­ì„ ë„˜ì–´ì„  ì˜ë¯¸ë¡ ì  ê²€ìƒ‰
âœ… <strong>AI ìš”ì•½ ê¸°ëŠ¥</strong>: ê²€ìƒ‰ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ ìš”ì•½
âœ… <strong>ë¹„ìš© íš¨ìœ¨ì </strong>: ì‚¬ìš©í•œ ë§Œí¼ë§Œ ê³¼ê¸ˆ, ìºì‹±ìœ¼ë¡œ ë¹„ìš© ìµœì†Œí™”

### ê°œì„  ì•„ì´ë””ì–´

<strong>1. ê²€ìƒ‰ í•„í„°ë§ ì¶”ê°€</strong>

ë‚ ì§œ ë²”ìœ„, íƒœê·¸, ì¹´í…Œê³ ë¦¬ë³„ í•„í„°ë§ ê¸°ëŠ¥:

```javascript
async function searchWithFilters(query, filters = {}) {
  const url = new URL(API_URL);
  url.searchParams.set('q', query);

  if (filters.startDate) {
    url.searchParams.set('start_date', filters.startDate);
  }

  if (filters.tags) {
    url.searchParams.set('tags', filters.tags.join(','));
  }

  const response = await fetch(url);
  return response.json();
}
```

<strong>2. ê²€ìƒ‰ì–´ ìë™ì™„ì„±</strong>

ì‚¬ìš©ìê°€ ì…ë ¥í•˜ëŠ” ë™ì•ˆ ê²€ìƒ‰ì–´ ì œì•ˆ:

```javascript
async function getAutocompleteSuggestions(query) {
  // Vertex AI Searchì˜ Autocomplete API í™œìš©
  const response = await fetch(`${API_URL}/autocomplete?q=${query}`);
  return response.json();
}
```

<strong>3. ê²€ìƒ‰ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</strong>

Google Analyticsì™€ í†µí•©í•˜ì—¬ ê²€ìƒ‰ íŒ¨í„´ ë¶„ì„:

```javascript
// Google Analytics ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹
function trackSearchEvent(query, resultsCount) {
  gtag('event', 'search', {
    'search_term': query,
    'results_count': resultsCount
  });
}
```

<strong>4. ë‹¤êµ­ì–´ ê²€ìƒ‰ ì§€ì›</strong>

ì—¬ëŸ¬ ì–¸ì–´ë¡œ ê²€ìƒ‰ ê²°ê³¼ ì œê³µ:

```javascript
async function searchSite(query, language = 'ko') {
  const url = new URL(API_URL);
  url.searchParams.set('q', query);
  url.searchParams.set('lang', language);

  const response = await fetch(url);
  return response.json();
}
```

### ë‹¤ìŒ ë‹¨ê³„

1. <strong>í”„ë¡œë•ì…˜ ë°°í¬</strong>
   - `.env.production` íŒŒì¼ ìƒì„±
   - ë„ë©”ì¸ ì œí•œ í™œì„±í™”
   - ëª¨ë‹ˆí„°ë§ ì•Œë¦¼ ì„¤ì •

2. <strong>ì„±ëŠ¥ ìµœì í™”</strong>
   - CDNì„ í†µí•œ API ì‘ë‹µ ìºì‹±
   - ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ë„¤ì´ì…˜
   - ë ˆì´ì§€ ë¡œë”© êµ¬í˜„

3. <strong>ì‚¬ìš©ì ê²½í—˜ ê°œì„ </strong>
   - ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŒ…
   - ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ ì €ì¥
   - ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥

4. <strong>ë³´ì•ˆ ê°•í™”</strong>
   - API í‚¤ ê¸°ë°˜ ì¸ì¦ ì¶”ê°€
   - Rate limiting êµ¬í˜„
   - HTTPS ê°•ì œ

### ì°¸ê³  ìë£Œ

<strong>ê³µì‹ ë¬¸ì„œ</strong>:
- [Vertex AI Search ê°œìš”](https://cloud.google.com/generative-ai-app-builder/docs/introduction)
- [Discovery Engine API ë ˆí¼ëŸ°ìŠ¤](https://cloud.google.com/generative-ai-app-builder/docs/reference/rest)
- [Cloud Functions ê°€ì´ë“œ](https://cloud.google.com/functions/docs)

<strong>ê´€ë ¨ ê¸°ìˆ </strong>:
- [Agent Builder ì‚¬ìš©ë²•](https://cloud.google.com/generative-ai-app-builder/docs/create-engine-es)
- [ì„¸ë§¨í‹± ê²€ìƒ‰ ì´í•´](https://en.wikipedia.org/wiki/Semantic_search)
- [Shell Script ì‘ì„± ê°€ì´ë“œ](https://www.shellscript.sh/)

<strong>ì»¤ë®¤ë‹ˆí‹° ë¦¬ì†ŒìŠ¤</strong>:
- [Google Cloud ì»¤ë®¤ë‹ˆí‹°](https://www.googlecloudcommunity.com/)
- [Stack Overflow - Vertex AI](https://stackoverflow.com/questions/tagged/vertex-ai)

---

<strong>ì´ì œ ì›¹ì‚¬ì´íŠ¸ì— ê°•ë ¥í•œ AI ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ë³´ì„¸ìš”! ğŸš€</strong>
