---
title: 'Tauri 2.x iOS ì•±ì— AdMob ë³´ìƒí˜• ê´‘ê³  ì—°ë™í•˜ê¸°: Swift í”ŒëŸ¬ê·¸ì¸ ê°œë°œ ê°€ì´ë“œ'
description: 'Tauri v2 iOS ì•±ì— Google AdMob ë³´ìƒí˜• ê´‘ê³ ë¥¼ ì—°ë™í•˜ëŠ” ì „ì²´ ê³¼ì •ì„ ë‹¤ë£¹ë‹ˆë‹¤. ê³µì‹ í”ŒëŸ¬ê·¸ì¸ì´ ì—†ì–´ ì§ì ‘ Swift í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•œ ê²½í—˜ì„ ê³µìœ í•©ë‹ˆë‹¤.'
pubDate: '2026-01-30'
heroImage: ../../../assets/portfolio/shadow-dash/app_icon.jpg
tags:
  - tauri
  - admob
  - ios
  - swift
relatedPosts:
  - slug: "tauri-pixijs-ios-game-development"
    score: 0.92
    reason:
      ko: "Taurië¡œ iOS ê²Œì„ì„ ê°œë°œí•˜ëŠ” ì „ì²´ ê³¼ì •ì„ ë‹¤ë£¨ë©°, ì´ í¬ìŠ¤íŠ¸ì˜ ì„ í–‰ ì§€ì‹ì´ ë©ë‹ˆë‹¤"
      ja: "Tauriã§iOSã‚²ãƒ¼ãƒ ã‚’é–‹ç™ºã™ã‚‹å…¨éç¨‹ã‚’æ‰±ã„ã€ã“ã®è¨˜äº‹ã®å‰æçŸ¥è­˜ã¨ãªã‚Šã¾ã™"
      en: "Covers the entire process of developing iOS games with Tauri, serving as prerequisite knowledge for this post"
      zh: "æ¶µç›–ä½¿ç”¨Tauriå¼€å‘iOSæ¸¸æˆçš„å®Œæ•´è¿‡ç¨‹ï¼Œæ˜¯æœ¬æ–‡çš„å‰ç½®çŸ¥è¯†"
  - slug: "individual-developer-ai-saas-journey"
    score: 0.78
    reason:
      ko: "ê°œì¸ ê°œë°œìì˜ ì•± ìˆ˜ìµí™” ì—¬ì •ìœ¼ë¡œ, ìˆ˜ìµ ëª¨ë¸ ì„¤ê³„ì— ì°¸ê³ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
      ja: "å€‹äººé–‹ç™ºè€…ã®ã‚¢ãƒ—ãƒªåç›ŠåŒ–ã®æ—…ã§ã€åç›Šãƒ¢ãƒ‡ãƒ«è¨­è¨ˆã®å‚è€ƒã«ãªã‚Šã¾ã™"
      en: "Individual developer's app monetization journey, useful reference for revenue model design"
      zh: "ä¸ªäººå¼€å‘è€…çš„åº”ç”¨å˜ç°ä¹‹æ—…ï¼Œå¯ä½œä¸ºæ”¶ç›Šæ¨¡å‹è®¾è®¡çš„å‚è€ƒ"
  - slug: "claude-code-plugins-complete-guide"
    score: 0.72
    reason:
      ko: "í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜ì™€ ê°œë°œ ë°©ë²•ë¡ ì—ì„œ ìœ ì‚¬í•œ ì ‘ê·¼ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤"
      ja: "ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨é–‹ç™ºæ–¹æ³•è«–ã§é¡ä¼¼ã—ãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ‰±ã„ã¾ã™"
      en: "Covers similar approaches in plugin architecture and development methodology"
      zh: "åœ¨æ’ä»¶æ¶æ„å’Œå¼€å‘æ–¹æ³•è®ºæ–¹é¢æ¶µç›–äº†ç±»ä¼¼çš„æ–¹æ³•"
---

import { Image } from 'astro:assets';
import screenshot01 from '../../../assets/portfolio/shadow-dash/shadow-dash-01_iphone.png';
import screenshot04 from '../../../assets/portfolio/shadow-dash/shadow-dash-04_iphone.png';

## ê°œìš”

Tauri 2.xë¡œ iOS ì•±ì„ ê°œë°œí–ˆëŠ”ë°, ìˆ˜ìµí™”ë¥¼ ìœ„í•´ AdMob ê´‘ê³ ë¥¼ ì—°ë™í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?

ì•ˆíƒ€ê¹ê²Œë„ **Tauriì—ëŠ” ê³µì‹ AdMob í”ŒëŸ¬ê·¸ì¸ì´ ì—†ìŠµë‹ˆë‹¤**. ì´ ê¸€ì—ì„œëŠ” ì§ì ‘ Swift í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•˜ì—¬ AdMob ë³´ìƒí˜• ê´‘ê³ ë¥¼ ì—°ë™í•œ ì „ì²´ ê³¼ì •ì„ ê³µìœ í•©ë‹ˆë‹¤.

> ì´ ê¸€ì€ [Tauri + PixiJSë¡œ iOS ê²Œì„ ê°œë°œ](/ko/blog/ko/tauri-pixijs-ios-game-development) í¬ìŠ¤íŠ¸ì˜ í›„ì†í¸ì…ë‹ˆë‹¤. Shadow Dash ê²Œì„ì— ê´‘ê³ ë¥¼ ì—°ë™í•œ ì‹¤ì œ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

<Image src={screenshot04} alt="Shadow Dash ê²Œì„ì˜¤ë²„ í™”ë©´" width={300} class="mx-auto rounded-lg shadow-lg" />

## ì™œ AdMobì¸ê°€?

### ëª¨ë°”ì¼ ê²Œì„ ìˆ˜ìµí™” ì˜µì…˜ ë¹„êµ

| ë°©ì‹ | ì¥ì  | ë‹¨ì  |
|------|------|------|
| **ë³´ìƒí˜• ê´‘ê³ ** | ì‚¬ìš©ì ê²½í—˜ ì¢‹ìŒ, ë†’ì€ eCPM | êµ¬í˜„ ë³µì¡ |
| ë°°ë„ˆ ê´‘ê³  | êµ¬í˜„ ê°„ë‹¨ | ë‚®ì€ eCPM, UX ì €í•´ |
| ì¸ì•± êµ¬ë§¤ | ë†’ì€ ìˆ˜ìµ | êµ¬í˜„ ë³µì¡, ê²°ì œ ì‹¬ì‚¬ |

### ë³´ìƒí˜• ê´‘ê³ ë¥¼ ì„ íƒí•œ ì´ìœ 

Shadow Dashì—ì„œëŠ” **ì»¨í‹°ë‰´ ì‹œìŠ¤í…œ**ì— ë³´ìƒí˜• ê´‘ê³ ë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤:

```mermaid
graph LR
    A[ê²Œì„ì˜¤ë²„] --> B["ê´‘ê³  ë³´ê³  ê³„ì†í•˜ê¸°" ë²„íŠ¼]
    B --> C[ê´‘ê³  ì‹œì²­]
    C --> D[ê²Œì„ ì¬ê°œ]
```

ì‚¬ìš©ìê°€ **ìë°œì ìœ¼ë¡œ** ê´‘ê³ ë¥¼ ì‹œì²­í•˜ê³  ë³´ìƒ(ê²Œì„ ê³„ì†)ì„ ë°›ëŠ” êµ¬ì¡°ë¡œ, ì‚¬ìš©ì ê²½í—˜ì„ í•´ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### ê´‘ê³  SDK ì„ íƒ ê³¼ì •

Tauri ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê´‘ê³  SDKë¥¼ ê²€í† í–ˆìŠµë‹ˆë‹¤:

| SDK | ì¥ì  | ë‹¨ì  | ì±„íƒ ì—¬ë¶€ |
|-----|------|------|----------|
| **AdMob** | ë†’ì€ eCPM, ë‹¤ì–‘í•œ ê´‘ê³  í˜•ì‹ | ë„¤ì´í‹°ë¸Œ í”ŒëŸ¬ê·¸ì¸ í•„ìš” | âœ… ì±„íƒ |
| AppLixir | JS SDKë§Œìœ¼ë¡œ ì—°ë™ ê°€ëŠ¥ | **DAU 5,000ëª… ì´ìƒ í•„ìš”** | âŒ ë¯¸ì±„íƒ |
| H5 Game Ads | HTML5 ê²Œì„ íŠ¹í™” | **ë² íƒ€ ì„œë¹„ìŠ¤ (ë¶ˆì•ˆì •)** | âŒ ë¯¸ì±„íƒ |

**AppLixirë¥¼ ì„ íƒí•˜ì§€ ì•Šì€ ì´ìœ **:
- ìµœì†Œ ì¼ì¼ í™œì„± ìœ ì €(DAU) 5,000ëª… ì´ìƒì„ ë‹¬ì„±í•´ì•¼ ì‹ ì²­ ê°€ëŠ¥
- ì‹ ê·œ ì•±ì—ì„œëŠ” ì´ ì¡°ê±´ì„ ì¶©ì¡±í•˜ê¸° ì–´ë ¤ì›€

**H5 Game Adsë¥¼ ì„ íƒí•˜ì§€ ì•Šì€ ì´ìœ **:
- ì•„ì§ ë² íƒ€ ì„œë¹„ìŠ¤ ë‹¨ê³„
- ì•ˆì •ì„±ê³¼ ìˆ˜ìµì„±ì´ ê²€ì¦ë˜ì§€ ì•ŠìŒ

### AdMob vs AppLixir ìƒì„¸ ë¹„êµ

AdMobê³¼ AppLixirì˜ ì„±ëŠ¥ì„ ë¹„êµí•˜ë©´:

| í•­ëª© | AdMob | AppLixir |
|------|-------|----------|
| eCPM (ë³´ìƒí˜•) | $20ã€œ30 | $15ã€œ25 |
| Fill Rate | 95%+ | 80ã€œ90% |
| ì§€ì› í˜•ì‹ | ë³´ìƒí˜•, ì „ë©´, ë°°ë„ˆ | ë³´ìƒí˜•ë§Œ |
| Mediation | ì§€ì› | ë¯¸ì§€ì› |
| ì—°ë™ ë‚œì´ë„ | ë†’ìŒ (ë„¤ì´í‹°ë¸Œ í•„ìš”) | ë‚®ìŒ (JS SDK) |
| ì§„ì… ì¥ë²½ | ì—†ìŒ | DAU 5,000ëª… ì´ìƒ |

**ê²°ë¡ **: ë„¤ì´í‹°ë¸Œ í”ŒëŸ¬ê·¸ì¸ ê°œë°œì´ í•„ìš”í•˜ì§€ë§Œ, AdMobì€ ì§„ì… ì¥ë²½ì´ ì—†ê³  ë†’ì€ eCPMê³¼ Fill Rateë¥¼ ì œê³µí•©ë‹ˆë‹¤.

---

## Tauri CLI ì—…ê·¸ë ˆì´ë“œ

### XCFramework ì§€ì› í•„ìš”

Tauri v2ì—ì„œ iOS í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•˜ë ¤ë©´ Swift Package Manager(SPM)ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. GoogleMobileAds SDKì²˜ëŸ¼ ì™¸ë¶€ í”„ë ˆì„ì›Œí¬ ì˜ì¡´ì„±ì´ í•„ìš”í•œ í”ŒëŸ¬ê·¸ì¸ì„ ë§Œë“¤ë ¤ë©´ **XCFramework ì§€ì›**ì´ í•„ìš”í•©ë‹ˆë‹¤.

### Tauri CLI 2.9.6+ ì—…ê·¸ë ˆì´ë“œ

```bash
# Cargoë¥¼ í†µí•œ Tauri CLI ì—…ê·¸ë ˆì´ë“œ
cargo install tauri-cli --force

# ë²„ì „ í™•ì¸
cargo tauri --version
# ì¶œë ¥: tauri-cli 2.9.6 (ë˜ëŠ” ê·¸ ì´ìƒ)
```

### --ios-framework ì˜µì…˜

í”ŒëŸ¬ê·¸ì¸ ìƒì„± ì‹œ iOS í”„ë ˆì„ì›Œí¬ íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# Xcode í”„ë¡œì íŠ¸ ë°©ì‹ (SPM ì˜ì¡´ì„± ì¶”ê°€ ìš©ì´) - ê¶Œì¥
cargo tauri plugin new admob --ios --ios-framework xcode

# XCFramework ë°©ì‹
cargo tauri plugin new admob --ios --ios-framework xcframework
```

| ì˜µì…˜ | ì„¤ëª… | ì¥ì  | ë‹¨ì  |
|------|------|------|------|
| `xcode` | Xcode í”„ë¡œì íŠ¸ ìƒì„± | SPMìœ¼ë¡œ ì˜ì¡´ì„± ì¶”ê°€ ìš©ì´ | í”„ë¡œì íŠ¸ íŒŒì¼ ê´€ë¦¬ í•„ìš” |
| `xcframework` | XCFramework ìƒì„± | ë°°í¬ ìš©ì´ | ì™¸ë¶€ ì˜ì¡´ì„± ì¶”ê°€ ë³µì¡ |

**AdMob í”ŒëŸ¬ê·¸ì¸ì—ëŠ” `xcode` ì˜µì…˜ ê¶Œì¥**: GoogleMobileAds SDKë¥¼ SPMìœ¼ë¡œ ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## Tauri í”ŒëŸ¬ê·¸ì¸ êµ¬ì¡° ì´í•´

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
tauri-plugin-admob/
â”œâ”€â”€ src/                    # Rust ì½”ë“œ
â”‚   â”œâ”€â”€ lib.rs             # í”ŒëŸ¬ê·¸ì¸ ì§„ì…ì 
â”‚   â”œâ”€â”€ mobile.rs          # iOS/Android ë¸Œë¦¿ì§€
â”‚   â”œâ”€â”€ desktop.rs         # ë°ìŠ¤í¬í†± ìŠ¤í…
â”‚   â”œâ”€â”€ commands.rs        # Tauri ì»¤ë§¨ë“œ
â”‚   â””â”€â”€ models.rs          # ìš”ì²­/ì‘ë‹µ íƒ€ì…
â”œâ”€â”€ ios/                    # iOS ë„¤ì´í‹°ë¸Œ ì½”ë“œ
â”‚   â””â”€â”€ tauri-plugin-admob/
â”‚       â””â”€â”€ AdmobPlugin.swift
â”œâ”€â”€ guest-js/              # TypeScript API
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ permissions/           # Tauri ê¶Œí•œ ì„¤ì •
â”‚   â””â”€â”€ default.toml
â”œâ”€â”€ build.rs               # ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ Cargo.toml
```

### ë°ì´í„° íë¦„

```mermaid
graph TD
    A[TypeScript] -->|invoke| B[Rust Command]
    B -->|run_mobile_plugin| C[Swift Plugin]
    C -->|API Call| D[GoogleMobileAds SDK]
    D -->|Response| C
    C -->|Result| B
    B -->|JSON| A
```

---

## í”ŒëŸ¬ê·¸ì¸ ê°œë°œ ì‹œì‘

### í”ŒëŸ¬ê·¸ì¸ ìŠ¤ìºí´ë”©

```bash
# Xcode í”„ë¡œì íŠ¸ ë°©ì‹ìœ¼ë¡œ ìƒì„±
cargo tauri plugin new admob --ios --ios-framework xcode
```

### GoogleMobileAds SDK ì¶”ê°€

Xcodeì—ì„œ í”ŒëŸ¬ê·¸ì¸ í”„ë¡œì íŠ¸ë¥¼ ì—´ê³  Swift Package Managerë¡œ SDK ì¶”ê°€:

1. `tauri-plugin-admob/ios/tauri-plugin-admob.xcodeproj` ì—´ê¸°
2. **File â†’ Add Package Dependencies**
3. URL ì…ë ¥: `https://github.com/googleads/swift-package-manager-google-mobile-ads`
4. **GoogleMobileAds** ì„ íƒ í›„ ì¶”ê°€

---

## Swift í”ŒëŸ¬ê·¸ì¸ êµ¬í˜„

### AdmobPlugin.swift

```swift
import SwiftRs
import Tauri
import UIKit
import WebKit
import GoogleMobileAds

// MARK: - Argument Types
class InitializeArgs: Decodable {}

class LoadRewardedArgs: Decodable {
    let adUnitId: String
}

class ShowRewardedArgs: Decodable {}

// MARK: - AdMob Plugin
class AdmobPlugin: Plugin {
    private var rewardedAd: GADRewardedAd?
    private var isInitialized = false
    private var pendingInvoke: Invoke?

    // í…ŒìŠ¤íŠ¸ ê´‘ê³  ID (í”„ë¡œë•ì…˜ì—ì„œëŠ” ì‹¤ì œ ID ì‚¬ìš©)
    private let testAdUnitId = "ca-app-pub-3940256099942544/1712485313"

    @objc public override func load(webview: WKWebView) {
        NSLog("[AdMob Plugin] Loaded")
    }

    // SDK ì´ˆê¸°í™”
    @objc public func initialize(_ invoke: Invoke) {
        if isInitialized {
            invoke.resolve(["success": true, "message": "Already initialized"])
            return
        }

        GADMobileAds.sharedInstance().start { status in
            self.isInitialized = true
            NSLog("[AdMob Plugin] SDK Initialized")
            invoke.resolve(["success": true, "message": "SDK initialized"])
        }
    }

    // ë³´ìƒí˜• ê´‘ê³  ë¡œë“œ
    @objc public func loadRewardedAd(_ invoke: Invoke) {
        do {
            let args = try invoke.parseArgs(LoadRewardedArgs.self)
            let adUnitId = args.adUnitId.isEmpty ? testAdUnitId : args.adUnitId

            let request = GADRequest()
            GADRewardedAd.load(withAdUnitID: adUnitId, request: request) { [weak self] ad, error in
                if let error = error {
                    invoke.resolve(["success": false, "error": error.localizedDescription])
                    return
                }

                self?.rewardedAd = ad
                self?.rewardedAd?.fullScreenContentDelegate = self
                invoke.resolve(["success": true])
            }
        } catch {
            invoke.reject(error.localizedDescription)
        }
    }

    // ê´‘ê³  ì¤€ë¹„ ìƒíƒœ í™•ì¸
    @objc public func isRewardedAdReady(_ invoke: Invoke) {
        let isReady = rewardedAd != nil
        invoke.resolve(["ready": isReady])
    }

    // ê´‘ê³  í‘œì‹œ
    @objc public func showRewardedAd(_ invoke: Invoke) {
        guard let rewardedAd = rewardedAd else {
            invoke.resolve(["success": false, "rewarded": false, "error": "No ad loaded"])
            return
        }

        guard let rootViewController = getRootViewController() else {
            invoke.resolve(["success": false, "rewarded": false, "error": "No root view controller"])
            return
        }

        pendingInvoke = invoke

        DispatchQueue.main.async {
            rewardedAd.present(fromRootViewController: rootViewController) { [weak self] in
                let reward = rewardedAd.adReward
                if let pending = self?.pendingInvoke {
                    pending.resolve([
                        "success": true,
                        "rewarded": true,
                        "rewardAmount": reward.amount.intValue,
                        "rewardType": reward.type
                    ])
                    self?.pendingInvoke = nil
                }
            }
        }
    }

    // Root View Controller ê°€ì ¸ì˜¤ê¸°
    private func getRootViewController() -> UIViewController? {
        if let windowScene = UIApplication.shared.connectedScenes
            .compactMap({ $0 as? UIWindowScene })
            .first(where: { $0.activationState == .foregroundActive }),
           let keyWindow = windowScene.windows.first(where: { $0.isKeyWindow }),
           let rootVC = keyWindow.rootViewController {
            var topController = rootVC
            while let presented = topController.presentedViewController {
                topController = presented
            }
            return topController
        }
        return nil
    }
}

// MARK: - GADFullScreenContentDelegate
extension AdmobPlugin: GADFullScreenContentDelegate {
    func adDidDismissFullScreenContent(_ ad: GADFullScreenPresentingAd) {
        rewardedAd = nil
        if let pending = pendingInvoke {
            pending.resolve(["success": true, "rewarded": false])
            pendingInvoke = nil
        }
    }

    func ad(_ ad: GADFullScreenPresentingAd, didFailToPresentFullScreenContentWithError error: Error) {
        rewardedAd = nil
        if let pending = pendingInvoke {
            pending.resolve(["success": false, "rewarded": false, "error": error.localizedDescription])
            pendingInvoke = nil
        }
    }
}

// MARK: - Plugin Export
@_cdecl("init_plugin_admob")
func initPlugin() -> Plugin {
    return AdmobPlugin()
}
```

### í•µì‹¬ í¬ì¸íŠ¸

1. **`@objc` ì–´ë…¸í…Œì´ì…˜**: Rustì—ì„œ í˜¸ì¶œí•˜ë ¤ë©´ Objective-C ëŸ°íƒ€ì„ì— ë…¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤
2. **`pendingInvoke` íŒ¨í„´**: ë¹„ë™ê¸° ê´‘ê³  ì½œë°±ì„ Tauriì˜ ë™ê¸° invoke íŒ¨í„´ì— ë§ì¶”ê¸° ìœ„í•´ ì‚¬ìš©
3. **`GADFullScreenContentDelegate`**: ê´‘ê³  ë‹«í˜/ì—ëŸ¬ ì´ë²¤íŠ¸ ì²˜ë¦¬
4. **`@_cdecl("init_plugin_admob")`**: Rustì—ì„œ í”ŒëŸ¬ê·¸ì¸ì„ ë¡œë“œí•˜ê¸° ìœ„í•œ C í•¨ìˆ˜ ë‚´ë³´ë‚´ê¸°

---

## Rust ë¸Œë¦¿ì§€ êµ¬í˜„

### models.rs

```rust
use serde::{Deserialize, Serialize};

#[derive(Debug, Clone, Default, Deserialize, Serialize)]
#[serde(rename_all = "camelCase")]
pub struct InitializeResponse {
    pub success: bool,
    pub message: Option<String>,
}

#[derive(Debug, Deserialize, Serialize)]
#[serde(rename_all = "camelCase")]
pub struct LoadRewardedAdRequest {
    pub ad_unit_id: String,
}

#[derive(Debug, Clone, Default, Deserialize, Serialize)]
#[serde(rename_all = "camelCase")]
pub struct LoadRewardedAdResponse {
    pub success: bool,
    pub error: Option<String>,
}

#[derive(Debug, Clone, Default, Deserialize, Serialize)]
#[serde(rename_all = "camelCase")]
pub struct IsRewardedAdReadyResponse {
    pub ready: bool,
}

#[derive(Debug, Clone, Default, Deserialize, Serialize)]
#[serde(rename_all = "camelCase")]
pub struct ShowRewardedAdResponse {
    pub success: bool,
    pub rewarded: bool,
    pub reward_amount: Option<i32>,
    pub reward_type: Option<String>,
    pub error: Option<String>,
}
```

### mobile.rs

```rust
use serde::de::DeserializeOwned;
use tauri::{
    plugin::{PluginApi, PluginHandle},
    AppHandle, Runtime,
};
use crate::models::*;

#[cfg(target_os = "ios")]
tauri::ios_plugin_binding!(init_plugin_admob);

pub fn init<R: Runtime, C: DeserializeOwned>(
    _app: &AppHandle<R>,
    api: PluginApi<R, C>,
) -> crate::Result<Admob<R>> {
    #[cfg(target_os = "ios")]
    let handle = api.register_ios_plugin(init_plugin_admob)?;
    Ok(Admob(handle))
}

pub struct Admob<R: Runtime>(PluginHandle<R>);

impl<R: Runtime> Admob<R> {
    pub fn initialize(&self) -> crate::Result<InitializeResponse> {
        self.0.run_mobile_plugin("initialize", ()).map_err(Into::into)
    }

    pub fn load_rewarded_ad(&self, ad_unit_id: String) -> crate::Result<LoadRewardedAdResponse> {
        self.0.run_mobile_plugin("loadRewardedAd",
            LoadRewardedAdRequest { ad_unit_id }).map_err(Into::into)
    }

    pub fn is_rewarded_ad_ready(&self) -> crate::Result<IsRewardedAdReadyResponse> {
        self.0.run_mobile_plugin("isRewardedAdReady", ()).map_err(Into::into)
    }

    pub fn show_rewarded_ad(&self) -> crate::Result<ShowRewardedAdResponse> {
        self.0.run_mobile_plugin("showRewardedAd", ()).map_err(Into::into)
    }
}
```

### build.rs (ì¤‘ìš”!)

```rust
const COMMANDS: &[&str] = &[
    "initialize",
    "load_rewarded_ad",
    "is_rewarded_ad_ready",
    "show_rewarded_ad"
];

fn main() {
    // iOS ë¹Œë“œ ì‹œ í”„ë ˆì„ì›Œí¬ ë§í¬
    let target = std::env::var("TARGET").unwrap_or_default();
    if target.contains("ios") {
        println!("cargo:rustc-link-lib=framework=GoogleMobileAds");
        println!("cargo:rustc-link-lib=framework=UserMessagingPlatform");
    }

    tauri_plugin::Builder::new(COMMANDS)
        .android_path("android")
        .ios_path("ios")
        .build();
}
```

**ì£¼ì˜**: `#[cfg(target_os = "ios")]`ëŠ” build.rsì—ì„œ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. build.rsëŠ” **í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ **(macOS)ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ, `std::env::var("TARGET")`ìœ¼ë¡œ íƒ€ê²Ÿì„ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.

---

## TypeScript API êµ¬í˜„

### guest-js/index.ts

```typescript
import { invoke } from '@tauri-apps/api/core'

export interface InitializeResponse {
  success: boolean;
  message?: string;
}

export interface LoadRewardedAdResponse {
  success: boolean;
  error?: string;
}

export interface IsRewardedAdReadyResponse {
  ready: boolean;
}

export interface ShowRewardedAdResponse {
  success: boolean;
  rewarded: boolean;
  rewardAmount?: number;
  rewardType?: string;
  error?: string;
}

export async function initialize(): Promise<InitializeResponse> {
  return await invoke<InitializeResponse>('plugin:admob|initialize');
}

export async function loadRewardedAd(adUnitId: string = ''): Promise<LoadRewardedAdResponse> {
  return await invoke<LoadRewardedAdResponse>('plugin:admob|load_rewarded_ad', {
    adUnitId,
  });
}

export async function isRewardedAdReady(): Promise<IsRewardedAdReadyResponse> {
  return await invoke<IsRewardedAdReadyResponse>('plugin:admob|is_rewarded_ad_ready');
}

export async function showRewardedAd(): Promise<ShowRewardedAdResponse> {
  return await invoke<ShowRewardedAdResponse>('plugin:admob|show_rewarded_ad');
}
```

---

## ì•±ì— í”ŒëŸ¬ê·¸ì¸ ì—°ë™

### Cargo.tomlì— í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€

```toml
[dependencies]
tauri-plugin-admob = { path = "../tauri-plugin-admob" }
```

### lib.rsì— í”ŒëŸ¬ê·¸ì¸ ë“±ë¡

```rust
pub fn run() {
    tauri::Builder::default()
        .plugin(tauri_plugin_admob::init())
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
```

### ê¶Œí•œ ì„¤ì •

**src-tauri/capabilities/default.json**:

```json
{
  "permissions": [
    "core:default",
    "admob:default"
  ]
}
```

**tauri-plugin-admob/permissions/default.toml**:

```toml
[default]
description = "Default permissions for the AdMob plugin"
permissions = [
    "allow-initialize",
    "allow-load-rewarded-ad",
    "allow-is-rewarded-ad-ready",
    "allow-show-rewarded-ad"
]
```

### Info.plistì— ì•± ID ì¶”ê°€

**src-tauri/gen/apple/ì•±ì´ë¦„_iOS/Info.plist**:

```xml
<key>GADApplicationIdentifier</key>
<string>ca-app-pub-XXXXXXXXXXXXXXXX~XXXXXXXXXX</string>
<key>SKAdNetworkItems</key>
<array>
    <dict>
        <key>SKAdNetworkIdentifier</key>
        <string>cstr6suwn9.skadnetwork</string>
    </dict>
</array>
```

---

## ê²Œì„ì—ì„œ ê´‘ê³  ì‚¬ìš©í•˜ê¸°

### ê´‘ê³  ì„¤ì • íŒŒì¼

**src/lib/config/admob.ts**:

```typescript
// ê´‘ê³  í™œì„±í™” í”Œë˜ê·¸ (ìŠ¹ì¸ ì „ê¹Œì§€ false)
export const ADS_ENABLED = false;

const TEST_AD_UNITS = {
  rewardedAd: 'ca-app-pub-3940256099942544/1712485313',
  appId: 'ca-app-pub-3940256099942544~1458002511',
};

const PRODUCTION_AD_UNITS = {
  rewardedAd: 'ca-app-pub-XXXXXXXX/XXXXXXXXXX',  // ì‹¤ì œ ê´‘ê³  ë‹¨ìœ„ ID
  appId: 'ca-app-pub-XXXXXXXX~XXXXXXXXXX',       // ì‹¤ì œ ì•± ID
};

const isDevelopment = import.meta.env.DEV;

export const AD_UNITS = isDevelopment ? TEST_AD_UNITS : PRODUCTION_AD_UNITS;
export const isTestMode = isDevelopment;
```

### ê²Œì„ì˜¤ë²„ í™”ë©´ì—ì„œ ì‚¬ìš©

```typescript
import { AD_UNITS, ADS_ENABLED } from '$lib/config/admob';
import * as admob from 'tauri-plugin-admob-api';

let adLoading = false;
let adError = '';

async function handleWatchAd() {
  if (!ADS_ENABLED) {
    // ê´‘ê³  ë¹„í™œì„±í™” ì‹œ ë°”ë¡œ ì»¨í‹°ë‰´
    game.startContinue();
    return;
  }

  adLoading = true;
  adError = '';

  try {
    // ê´‘ê³  ì¤€ë¹„ ìƒíƒœ í™•ì¸
    const readyCheck = await admob.isRewardedAdReady();

    if (!readyCheck.ready) {
      // ê´‘ê³ ê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ë¡œë“œ
      const loadResult = await admob.loadRewardedAd(AD_UNITS.rewardedAd);
      if (!loadResult.success) {
        adError = loadResult.error || 'Failed to load ad';
        adLoading = false;
        return;
      }
    }

    // ê´‘ê³  í‘œì‹œ
    const showResult = await admob.showRewardedAd();

    if (showResult.rewarded) {
      // ë³´ìƒ ë°›ìŒ - ê²Œì„ ê³„ì†
      game.startContinue();
    } else if (showResult.error) {
      adError = showResult.error;
    }
  } catch (error) {
    adError = String(error);
  } finally {
    adLoading = false;
  }
}
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Swift íƒ€ì… ì—ëŸ¬: "cannot find type 'RewardedAd' in scope"

**ì›ì¸**: GoogleMobileAds SDKëŠ” Objective-C ê¸°ë°˜ìœ¼ë¡œ, Swiftì—ì„œ ì‚¬ìš©í•  ë•Œ `GAD` ì ‘ë‘ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.

```swift
// âŒ ì˜ëª»ëœ ì½”ë“œ
private var rewardedAd: RewardedAd?

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ
private var rewardedAd: GADRewardedAd?
```

### ë§ì»¤ ì—ëŸ¬: "Undefined symbols for architecture arm64"

**ì›ì¸**: GoogleMobileAds í”„ë ˆì„ì›Œí¬ê°€ ë§í¬ë˜ì§€ ì•ŠìŒ

**í•´ê²° 1**: ë©”ì¸ ì•± Xcode í”„ë¡œì íŠ¸ì—ë„ SDK ì¶”ê°€

1. `src-tauri/gen/apple/ì•±ì´ë¦„.xcodeproj` ì—´ê¸°
2. **File â†’ Add Package Dependencies**
3. GoogleMobileAds SDK ì¶”ê°€

**í•´ê²° 2**: build.rsì—ì„œ í”„ë ˆì„ì›Œí¬ ë§í¬

```rust
let target = std::env::var("TARGET").unwrap_or_default();
if target.contains("ios") {
    println!("cargo:rustc-link-lib=framework=GoogleMobileAds");
}
```

### Tauri ê¶Œí•œ ì—ëŸ¬

**ì—ëŸ¬ ë©”ì‹œì§€**:
```
admob.is_rewarded_ad_ready not allowed.
Permissions associated with this command: admob:allow-is-rewarded-ad-ready
```

**í•´ê²°**: `permissions/default.toml`ê³¼ `capabilities/default.json`ì— ê¶Œí•œ ì¶”ê°€

### ê´‘ê³ ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

**ì¦ìƒ**: ë²„íŠ¼ í´ë¦­í•´ë„ ê´‘ê³  ì•ˆ ë‚˜ì˜´

**í™•ì¸ ì‚¬í•­**:
1. í…ŒìŠ¤íŠ¸ ê´‘ê³  ID ì‚¬ìš© ì¤‘ì¸ì§€ í™•ì¸
2. `GADMobileAds.sharedInstance().start()` í˜¸ì¶œ í™•ì¸
3. ì‹¤ì œ ê¸°ê¸°ì—ì„œ í…ŒìŠ¤íŠ¸ (ì‹œë®¬ë ˆì´í„° ì§€ì› ì œí•œì )

---

## ìˆ˜ìµí™” ì „ëµ ê³ ì°°

### ë‹¨ê³„ë³„ ë„ì… ê³„íš

```mermaid
graph TD
    subgraph 1ì°¨["1ì°¨ ë„ì… (í˜„ì¬)"]
        A[ë³´ìƒí˜• ì»¨í‹°ë‰´ ê´‘ê³ ë§Œ]
    end

    subgraph 2ì°¨["2ì°¨ ë„ì… (1ã€œ2ê°œì›” í›„)"]
        B[ì „ë©´ ê´‘ê³  ì¶”ê°€]
        C[ì½”ì¸ 2ë°° ê´‘ê³ ]
    end

    subgraph 3ì°¨["3ì°¨ ë„ì… (3ê°œì›” í›„)"]
        D[IAP: ê´‘ê³  ì œê±°]
        E[IAP: ì½”ì¸ íŒ¨í‚¤ì§€]
    end

    1ì°¨ --> 2ì°¨
    2ì°¨ --> 3ì°¨
```

### ìˆ˜ìµí™” 3ëŒ€ ì›ì¹™

1. **ê²Œì„ ë°¸ëŸ°ìŠ¤ ë³´í˜¸**: ê³¼ê¸ˆì€ ì™¸í˜•ë§Œ, ëŠ¥ë ¥ì¹˜ íŒë§¤ ê¸ˆì§€
2. **ë¬´ê³¼ê¸ˆ ìœ ì € ì¡´ì¤‘**: ëª¨ë“  ì½˜í…ì¸  ë¬´ë£Œ íšë“ ê°€ëŠ¥
3. **ê°€ì¹˜ ì œê³µ ìš°ì„ **: ìœ ì €ê°€ "ì“¸ ê°€ì¹˜ê°€ ìˆë‹¤"ê³  ëŠë¼ëŠ” ìƒí’ˆ

### ì˜ˆìƒ ìˆ˜ìµ (DAU 10,000ëª… ê¸°ì¤€)

| ë‹¨ê³„ | ê´‘ê³  ìœ í˜• | ì¼ì¼ ìˆ˜ìµ | ì›”ê°„ ìˆ˜ìµ |
|------|----------|----------|----------|
| 1ì°¨ | ë³´ìƒí˜•ë§Œ | ~$130 | ~$3,900 |
| 2ì°¨ | ë³´ìƒí˜• + ì „ë©´ | ~$425 | ~$12,750 |
| 3ì°¨ | ê´‘ê³  + IAP | ~$600 | ~$18,000 |

---

## ê²°ë¡ 

### ë°°ìš´ ì 

1. **Tauri CLI ìµœì‹  ë²„ì „ ìœ ì§€**: XCFramework ì§€ì› ë“± ì¤‘ìš”í•œ ê¸°ëŠ¥ì´ ê³„ì† ì¶”ê°€ë¨
2. **Tauri í”ŒëŸ¬ê·¸ì¸ êµ¬ì¡°**: Rust â†” Swift ë¸Œë¦¿ì§€ ì´í•´ í•„ìˆ˜
3. **í¬ë¡œìŠ¤ ì»´íŒŒì¼**: build.rsì—ì„œ HOST vs TARGET êµ¬ë¶„ ì¤‘ìš”
4. **Tauri v2 ê¶Œí•œ ì‹œìŠ¤í…œ**: capabilitiesì™€ permissions í•„ìˆ˜

### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Tauri CLI ìµœì‹  ë²„ì „ ì—…ê·¸ë ˆì´ë“œ (`cargo install tauri-cli --force`)
- [ ] `--ios-framework xcode` ì˜µì…˜ìœ¼ë¡œ í”ŒëŸ¬ê·¸ì¸ ìƒì„±
- [ ] GoogleMobileAds SDKë¥¼ **ë©”ì¸ ì•±**ê³¼ **í”ŒëŸ¬ê·¸ì¸** ëª¨ë‘ì— ì¶”ê°€
- [ ] build.rsì—ì„œ `std::env::var("TARGET")`ìœ¼ë¡œ iOS ê°ì§€
- [ ] `permissions/default.toml`ì— ëª¨ë“  ëª…ë ¹ì–´ ê¶Œí•œ ì •ì˜
- [ ] `capabilities/default.json`ì— `admob:default` ì¶”ê°€
- [ ] Info.plistì— `GADApplicationIdentifier` ì¶”ê°€
- [ ] í…ŒìŠ¤íŠ¸/í”„ë¡œë•ì…˜ ê´‘ê³  ID ë¶„ë¦¬ ê´€ë¦¬

### ë‹¤ìŒ ë‹¨ê³„

- Android ì§€ì› ì¶”ê°€
- ì „ë©´ ê´‘ê³  êµ¬í˜„
- ë°°ë„ˆ ê´‘ê³  êµ¬í˜„
- ì¸ì•± ê²°ì œ (StoreKit 2) ì—°ë™

---

## Shadow Dash ë‹¤ìš´ë¡œë“œ

ì´ ê¸€ì—ì„œ ë‹¤ë£¬ ê¸°ìˆ ë¡œ ê°œë°œí•œ **Shadow Dash**ë¥¼ ì§ì ‘ í”Œë ˆì´í•´ë³´ì„¸ìš”!

<a href="https://apps.apple.com/app/shadow-dash/id6740092498" target="_blank" rel="noopener noreferrer">
  <img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg" alt="Download on the App Store" style="height: 40px;" />
</a>

**í”¼ë“œë°± í™˜ì˜í•©ë‹ˆë‹¤!** ì•±ì„ í”Œë ˆì´í•˜ì‹œê³  ê°œì„ ì ì´ë‚˜ ë²„ê·¸ê°€ ìˆë‹¤ë©´ App Store ë¦¬ë·°ë‚˜ ì´ë©”ì¼ë¡œ ì•Œë ¤ì£¼ì„¸ìš”.

> ğŸ“± **Shadow Dash ìƒì„¸ ì •ë³´**: [í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€](/ko/portfolio/shadow-dash)ì—ì„œ ê²Œì„ì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ê³¼ ë” ë§ì€ ìŠ¤í¬ë¦°ìƒ·ì„ í™•ì¸í•˜ì„¸ìš”.

## ì°¸ê³  ìë£Œ

- [Tauri 2.0 ê³µì‹ ë¬¸ì„œ](https://v2.tauri.app/)
- [Google AdMob iOS ë¬¸ì„œ](https://developers.google.com/admob/ios/quick-start)
- [Swift Package Manager for Google Mobile Ads](https://github.com/googleads/swift-package-manager-google-mobile-ads)
- [Tauri Plugin Development](https://v2.tauri.app/develop/plugins/)
