---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getStaticPaths as getI18nStaticPaths } from '../../lib/i18n/utils';
import { useTranslations, type Language } from '../../lib/i18n/languages';

export function getStaticPaths() {
	return getI18nStaticPaths();
}

const { lang } = Astro.params as { lang: Language };
const t = useTranslations(lang);

// Load all improvement JSON files
const improvementFiles = import.meta.glob('../../data/improvements/*.json', { eager: true });

// Extract improvements and add sourceReport with lang variable
const improvements = Object.values(improvementFiles).map((file: any) => {
  const improvement = file.default;

  // Replace {lang} placeholder in sourceReport with actual lang
  if (improvement.sourceReport && typeof improvement.sourceReport === 'string') {
    improvement.sourceReport = improvement.sourceReport.replace('{lang}', lang);
  }

  return improvement;
});

// Legacy: Keep this comment for reference
// const improvements = [

// Split improvements by status
const plannedImprovements = improvements.filter(i => i.status === 'planned');
const completedImprovements = improvements
  .filter(i => i.status === 'completed')
  .sort((a, b) => {
    // Sort by completedDate in descending order (most recent first)
    const dateA = a.completedDate ? new Date(a.completedDate).getTime() : 0;
    const dateB = b.completedDate ? new Date(b.completedDate).getTime() : 0;
    return dateB - dateA;
  });
const inProgressImprovements = improvements.filter(i => i.status === 'in-progress');

const categories = {
  'Traffic': improvements.filter(i => i.category === 'Traffic'),
  'Content': improvements.filter(i => i.category === 'Content'),
  'SEO': improvements.filter(i => i.category === 'SEO'),
  'UX': improvements.filter(i => i.category === 'UX'),
  'Technical': improvements.filter(i => i.category === 'Technical'),
};

const metrics = {
  totalPlanned: plannedImprovements.length,
  totalInProgress: inProgressImprovements.length,
  totalCompleted: completedImprovements.length,
  avgImpact: completedImprovements.length > 0
    ? (completedImprovements.reduce((sum, i) => sum + parseFloat(i.impact || 0), 0) / completedImprovements.length).toFixed(1)
    : 0,
  topCategory: Object.entries(categories).sort((a, b) => b[1].length - a[1].length)[0]?.[0] || 'N/A'
};

// Translations
const translations = {
  title: {
    ko: 'ì ì§„ì  ì‚¬ì´íŠ¸ ê°œì„  íˆìŠ¤í† ë¦¬',
    en: 'Progressive Site Improvement History',
    ja: 'æ®µéšçš„ã‚µã‚¤ãƒˆæ”¹å–„å±¥æ­´',
    zh: 'æ¸è¿›å¼ç½‘ç«™æ”¹è¿›å†å²'
  },
  description: {
    ko: 'ë°ì´í„° ê¸°ë°˜ì˜ ì§€ì†ì ì¸ ì‚¬ì´íŠ¸ ê°œì„  ê³¼ì •ê³¼ ì„±ê³¼ë¥¼ íˆ¬ëª…í•˜ê²Œ ê³µìœ í•©ë‹ˆë‹¤',
    en: 'Transparently sharing data-driven continuous site improvement processes and results',
    ja: 'ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ãŸç¶™ç¶šçš„ãªã‚µã‚¤ãƒˆæ”¹å–„ãƒ—ãƒ­ã‚»ã‚¹ã¨æˆæœã‚’é€æ˜ã«å…±æœ‰ã—ã¾ã™',
    zh: 'é€æ˜åˆ†äº«åŸºäºæ•°æ®çš„æŒç»­ç½‘ç«™æ”¹è¿›è¿‡ç¨‹å’Œæˆæœ'
  },
  stats: {
    planned: { ko: 'ê³„íšë¨', en: 'Planned', ja: 'è¨ˆç”»æ¸ˆã¿', zh: 'å·²è®¡åˆ’' },
    inProgress: { ko: 'ì§„í–‰ ì¤‘', en: 'In Progress', ja: 'é€²è¡Œä¸­', zh: 'è¿›è¡Œä¸­' },
    completed: { ko: 'ì™„ë£Œë¨', en: 'Completed', ja: 'å®Œäº†', zh: 'å·²å®Œæˆ' },
    avgImpact: { ko: 'í‰ê·  ê°œì„  íš¨ê³¼', en: 'Average Impact', ja: 'å¹³å‡æ”¹å–„åŠ¹æœ', zh: 'å¹³å‡æ”¹è¿›æ•ˆæœ' },
    topCategory: { ko: 'ìµœë‹¤ ê°œì„  ì¹´í…Œê³ ë¦¬', en: 'Top Category', ja: 'æœ€å¤šæ”¹å–„ã‚«ãƒ†ã‚´ãƒª', zh: 'æœ€å¤šæ”¹è¿›ç±»åˆ«' }
  },
  sections: {
    planned: { ko: 'ê³„íšëœ ê°œì„ ì‚¬í•­', en: 'Planned Improvements', ja: 'è¨ˆç”»ã•ã‚ŒãŸæ”¹å–„äº‹é …', zh: 'è®¡åˆ’çš„æ”¹è¿›é¡¹' },
    inProgress: { ko: 'ì§„í–‰ ì¤‘ì¸ ê°œì„ ì‚¬í•­', en: 'In Progress', ja: 'é€²è¡Œä¸­ã®æ”¹å–„äº‹é …', zh: 'è¿›è¡Œä¸­çš„æ”¹è¿›é¡¹' },
    completed: { ko: 'ì™„ë£Œëœ ê°œì„ ì‚¬í•­', en: 'Completed Improvements', ja: 'å®Œäº†ã—ãŸæ”¹å–„äº‹é …', zh: 'å·²å®Œæˆçš„æ”¹è¿›é¡¹' }
  },
  emptyState: {
    title: {
      ko: 'ì•„ì§ ê°œì„  ì‚¬í•­ì´ ê¸°ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤',
      en: 'No improvements recorded yet',
      ja: 'ã¾ã æ”¹å–„äº‹é …ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“',
      zh: 'å°šæœªè®°å½•æ”¹è¿›é¡¹'
    },
    subtitle: {
      ko: 'ì²« ë²ˆì§¸ ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ê³  ê°œì„  ì‘ì—…ì„ ì‹œì‘í•´ë³´ì„¸ìš”!',
      en: 'Generate your first analytics report and start improvement work!',
      ja: 'æœ€åˆã®åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¦æ”¹å–„ä½œæ¥­ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼',
      zh: 'ç”Ÿæˆç¬¬ä¸€ä»½åˆ†ææŠ¥å‘Šå¹¶å¼€å§‹æ”¹è¿›å·¥ä½œï¼'
    },
    steps: {
      ko: [
        '1. analytics-reporter ì—ì´ì „íŠ¸ë¡œ ì²« ë¦¬í¬íŠ¸ ìƒì„±',
        '2. improvement-tracker ì—ì´ì „íŠ¸ë¡œ ì•¡ì…˜ í”Œëœì„ TODOë¡œ ë³€í™˜',
        '3. ê°œì„  ì‘ì—… ì™„ë£Œ í›„ ê²°ê³¼ ê¸°ë¡'
      ],
      en: [
        '1. Generate first report with analytics-reporter agent',
        '2. Convert action plan to TODOs with improvement-tracker agent',
        '3. Complete improvements and record results'
      ],
      ja: [
        '1. analytics-reporterã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§æœ€åˆã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ',
        '2. improvement-trackerã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã‚’TODOã«å¤‰æ›',
        '3. æ”¹å–„ä½œæ¥­å®Œäº†å¾Œã€çµæœã‚’è¨˜éŒ²'
      ],
      zh: [
        '1. ä½¿ç”¨ analytics-reporter ä»£ç†ç”Ÿæˆç¬¬ä¸€ä»½æŠ¥å‘Š',
        '2. ä½¿ç”¨ improvement-tracker ä»£ç†å°†è¡ŒåŠ¨è®¡åˆ’è½¬æ¢ä¸ºå¾…åŠäº‹é¡¹',
        '3. å®Œæˆæ”¹è¿›å·¥ä½œåè®°å½•ç»“æœ'
      ]
    }
  },
  filters: {
    all: { ko: 'ì „ì²´', en: 'All', ja: 'å…¨ã¦', zh: 'å…¨éƒ¨' },
    traffic: { ko: 'íŠ¸ë˜í”½', en: 'Traffic', ja: 'ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯', zh: 'æµé‡' },
    content: { ko: 'ì½˜í…ì¸ ', en: 'Content', ja: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', zh: 'å†…å®¹' },
    seo: { ko: 'SEO', en: 'SEO', ja: 'SEO', zh: 'SEO' },
    ux: { ko: 'UX', en: 'UX', ja: 'UX', zh: 'ç”¨æˆ·ä½“éªŒ' },
    technical: { ko: 'ê¸°ìˆ ', en: 'Technical', ja: 'æŠ€è¡“', zh: 'æŠ€æœ¯' }
  },
  metrics: {
    target: { ko: 'ëª©í‘œ', en: 'Target', ja: 'ç›®æ¨™', zh: 'ç›®æ ‡' },
    before: { ko: 'ê°œì„  ì „', en: 'Before', ja: 'æ”¹å–„å‰', zh: 'æ”¹è¿›å‰' },
    after: { ko: 'ê°œì„  í›„', en: 'After', ja: 'æ”¹å–„å¾Œ', zh: 'æ”¹è¿›å' },
    impact: { ko: 'íš¨ê³¼', en: 'Impact', ja: 'åŠ¹æœ', zh: 'æ•ˆæœ' },
    expectedImpact: { ko: 'ì˜ˆìƒ íš¨ê³¼', en: 'Expected Impact', ja: 'äºˆæƒ³åŠ¹æœ', zh: 'é¢„æœŸæ•ˆæœ' },
    effort: { ko: 'íˆ¬ì…', en: 'Effort', ja: 'æŠ•å…¥', zh: 'æŠ•å…¥' },
    roi: { ko: 'ROI', en: 'ROI', ja: 'ROI', zh: 'ROI' },
    date: { ko: 'ëª©í‘œì¼', en: 'Target Date', ja: 'ç›®æ¨™æ—¥', zh: 'ç›®æ ‡æ—¥æœŸ' },
    status: { ko: 'ìƒíƒœ', en: 'Status', ja: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', zh: 'çŠ¶æ€' }
  },
  lessons: {
    title: { ko: 'ë°°ìš´ ì ', en: 'Lessons Learned', ja: 'å­¦ã‚“ã ã“ã¨', zh: 'ç»éªŒæ€»ç»“' }
  },
  sourceReport: {
    ko: 'ì¶œì²˜ ë¦¬í¬íŠ¸ ë³´ê¸°',
    en: 'View Source Report',
    ja: 'ã‚½ãƒ¼ã‚¹ãƒ¬ãƒãƒ¼ãƒˆã‚’è¦‹ã‚‹',
    zh: 'æŸ¥çœ‹æ¥æºæŠ¥å‘Š'
  },
  dataSection: {
    title: { ko: 'ë°ì´í„° ì¶œì²˜ ë° ê´€ë¦¬', en: 'Data Sources & Management', ja: 'ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ç®¡ç†', zh: 'æ•°æ®æ¥æºä¸ç®¡ç†' },
    analytics: { ko: 'ë¶„ì„ ë„êµ¬', en: 'Analytics Tool', ja: 'åˆ†æãƒ„ãƒ¼ãƒ«', zh: 'åˆ†æå·¥å…·' },
    reports: { ko: 'ë¦¬í¬íŠ¸', en: 'Reports', ja: 'ãƒ¬ãƒãƒ¼ãƒˆ', zh: 'æŠ¥å‘Š' },
    todos: { ko: 'TODO ê´€ë¦¬', en: 'TODO Management', ja: 'TODOç®¡ç†', zh: 'å¾…åŠäº‹é¡¹ç®¡ç†' },
    autoUpdate: { ko: 'ìë™ ì—…ë°ì´íŠ¸', en: 'Auto Update', ja: 'è‡ªå‹•æ›´æ–°', zh: 'è‡ªåŠ¨æ›´æ–°' },
    description: {
      ko: 'ì´ í˜ì´ì§€ëŠ” ë¸”ë¡œê·¸ì˜ ì§€ì†ì ì¸ ê°œì„  ê³¼ì •ì„ íˆ¬ëª…í•˜ê²Œ ê³µìœ í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. ëª¨ë“  ê°œì„ ì‚¬í•­ì€ ë°ì´í„°ì— ê¸°ë°˜í•˜ë©°, ì‹¤ì œ ì¸¡ì •ëœ ê²°ê³¼ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤.',
      en: 'This page was created to transparently share the continuous improvement process of the blog. All improvements are data-driven and record actual measured results.',
      ja: 'ã“ã®ãƒšãƒ¼ã‚¸ã¯ãƒ–ãƒ­ã‚°ã®ç¶™ç¶šçš„ãªæ”¹å–„ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€æ˜ã«å…±æœ‰ã™ã‚‹ãŸã‚ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚ã™ã¹ã¦ã®æ”¹å–„ã¯ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ãŠã‚Šã€å®Ÿéš›ã«æ¸¬å®šã•ã‚ŒãŸçµæœã‚’è¨˜éŒ²ã—ã¾ã™ã€‚',
      zh: 'æœ¬é¡µé¢æ—¨åœ¨é€æ˜åœ°åˆ†äº«åšå®¢çš„æŒç»­æ”¹è¿›è¿‡ç¨‹ã€‚æ‰€æœ‰æ”¹è¿›é¡¹å‡åŸºäºæ•°æ®é©±åŠ¨ï¼Œå¹¶è®°å½•å®é™…æµ‹é‡ç»“æœã€‚'
    }
  }
};

const tt = (key: any) => {
  if (typeof key === 'object' && key !== null) {
    return key[lang] || key['en'] || '';
  }
  return key;
};
---

<!doctype html>
<html lang={lang}>
	<head>
		<BaseHead
			title={`${tt(translations.title)} - ${t('site.title')}`}
			description={tt(translations.description)}
		/>
		<style>
			.improvement-grid {
				display: grid;
				gap: 2rem;
				margin-top: 2rem;
			}

			.improvement-card {
				border: 1px solid var(--gray-200);
				border-radius: 8px;
				padding: 1.5rem;
				background: var(--gray-50);
				transition: transform 0.2s, box-shadow 0.2s;
			}

			.improvement-card:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
			}

			.card-header {
				display: flex;
				justify-content: space-between;
				align-items: start;
				margin-bottom: 1rem;
			}

			.card-title {
				font-size: 1.25rem;
				font-weight: 600;
				margin: 0;
			}

			.category-badge {
				padding: 0.25rem 0.75rem;
				border-radius: 12px;
				font-size: 0.875rem;
				font-weight: 500;
			}

			.category-traffic { background: #e0f2fe; color: #0369a1; }
			.category-content { background: #fce7f3; color: #9f1239; }
			.category-seo { background: #dcfce7; color: #15803d; }
			.category-ux { background: #fef3c7; color: #a16207; }
			.category-technical { background: #e0e7ff; color: #4338ca; }

			.metrics-row {
				display: flex;
				gap: 1rem;
				margin: 1rem 0;
				flex-wrap: wrap;
			}

			.metric {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				padding: 0.5rem 1rem;
				background: white;
				border-radius: 6px;
				font-size: 0.875rem;
			}

			.metric-label {
				color: var(--gray-600);
			}

			.metric-value {
				font-weight: 600;
			}

			.impact-positive {
				color: #15803d;
			}

			.impact-negative {
				color: #dc2626;
			}

			.timeline {
				position: relative;
				padding-left: 2rem;
			}

			.timeline::before {
				content: '';
				position: absolute;
				left: 0.5rem;
				top: 0;
				bottom: 0;
				width: 2px;
				background: var(--gray-300);
			}

			.timeline-item {
				position: relative;
				margin-bottom: 2rem;
			}

			.timeline-item::before {
				content: '';
				position: absolute;
				left: -1.5rem;
				top: 0.5rem;
				width: 12px;
				height: 12px;
				border-radius: 50%;
				background: var(--accent);
				border: 2px solid white;
			}

			.before-after {
				display: grid;
				grid-template-columns: 1fr auto 1fr;
				gap: 1rem;
				align-items: center;
				margin: 1rem 0;
				padding: 1rem;
				background: white;
				border-radius: 6px;
			}

			.before, .after {
				text-align: center;
			}

			.arrow {
				font-size: 1.5rem;
				color: var(--gray-400);
			}

			.value {
				font-size: 1.5rem;
				font-weight: 700;
			}

			.lessons {
				margin-top: 1rem;
				padding: 1rem;
				background: #fef9c3;
				border-left: 3px solid #facc15;
				border-radius: 4px;
			}

			.lessons-title {
				font-weight: 600;
				margin-bottom: 0.5rem;
				color: #a16207;
			}

			.lessons ul {
				margin: 0;
				padding-left: 1.5rem;
			}

			.empty-state {
				text-align: center;
				padding: 4rem 2rem;
				color: var(--gray-500);
			}

			.empty-state-icon {
				font-size: 4rem;
				margin-bottom: 1rem;
			}

			.stats-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 1.5rem;
				margin: 2rem 0;
			}

			.stat-card {
				padding: 1.5rem;
				background: white;
				border-radius: 8px;
				box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
			}

			.stat-value {
				font-size: 2rem;
				font-weight: 700;
				color: var(--accent);
			}

			.stat-label {
				margin-top: 0.5rem;
				color: var(--gray-600);
				font-size: 0.875rem;
			}

			.filter-tabs {
				display: flex;
				gap: 0.5rem;
				margin: 2rem 0;
				border-bottom: 2px solid var(--gray-200);
				padding-bottom: 0;
				flex-wrap: wrap;
			}

			.filter-tab {
				padding: 0.75rem 1.5rem;
				background: none;
				border: none;
				cursor: pointer;
				color: var(--gray-600);
				font-weight: 500;
				border-bottom: 2px solid transparent;
				margin-bottom: -2px;
				transition: all 0.2s;
			}

			.filter-tab:hover {
				color: var(--accent);
			}

			.filter-tab.active {
				color: var(--accent);
				border-bottom-color: var(--accent);
			}

			.data-section {
				margin-top: 4rem;
				padding: 2rem;
				background: var(--gray-50);
				border-radius: 8px;
			}
		</style>
	</head>
	<body>
		<Header lang={lang} />
		<main class="max-w-6xl mx-auto px-4 py-12">
			<section>
				<div class="mb-8">
					<h1 class="text-4xl font-bold mb-4">ğŸš€ {tt(translations.title)}</h1>
					<p class="text-xl text-gray-600">{tt(translations.description)}</p>
				</div>

				<!-- Summary Stats -->
				<div class="stats-grid">
					<div class="stat-card">
						<div class="stat-value">{metrics.totalPlanned}</div>
						<div class="stat-label">{tt(translations.stats.planned)}</div>
					</div>
					<div class="stat-card">
						<div class="stat-value">{metrics.totalInProgress}</div>
						<div class="stat-label">{tt(translations.stats.inProgress)}</div>
					</div>
					<div class="stat-card">
						<div class="stat-value">{metrics.totalCompleted}</div>
						<div class="stat-label">{tt(translations.stats.completed)}</div>
					</div>
					<div class="stat-card">
						<div class="stat-value">{metrics.topCategory}</div>
						<div class="stat-label">{tt(translations.stats.topCategory)}</div>
					</div>
				</div>

				{improvements.length === 0 ? (
					<div class="empty-state">
						<div class="empty-state-icon">ğŸ“Š</div>
						<h2 class="text-2xl font-bold mb-4">{tt(translations.emptyState.title)}</h2>
						<p class="text-lg mb-6">{tt(translations.emptyState.subtitle)}</p>
						<div class="text-left max-w-2xl mx-auto">
							<p class="font-semibold mb-2">{lang === 'ko' ? 'ë‹¤ìŒ ë‹¨ê³„:' : lang === 'ja' ? 'æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:' : lang === 'zh' ? 'ä¸‹ä¸€æ­¥:' : 'Next Steps:'}</p>
							<ul class="list-disc list-inside space-y-2">
								{tt(translations.emptyState.steps).map((step: string) => (
									<li>{step}</li>
								))}
							</ul>
						</div>
					</div>
				) : (
					<>
						<!-- Category Filters -->
						<div class="filter-tabs">
							<button class="filter-tab active" data-category="all">{tt(translations.filters.all)}</button>
							<button class="filter-tab" data-category="Traffic">{tt(translations.filters.traffic)}</button>
							<button class="filter-tab" data-category="Content">{tt(translations.filters.content)}</button>
							<button class="filter-tab" data-category="SEO">{tt(translations.filters.seo)}</button>
							<button class="filter-tab" data-category="UX">{tt(translations.filters.ux)}</button>
							<button class="filter-tab" data-category="Technical">{tt(translations.filters.technical)}</button>
						</div>

						<!-- Planned Improvements Section -->
						{plannedImprovements.length > 0 && (
							<div style="margin-top: 3rem;">
								<h2 class="text-3xl font-bold mb-4">ğŸ“‹ {tt(translations.sections.planned)}</h2>
								<div class="timeline">
									{plannedImprovements.map((item) => (
										<div class="timeline-item" data-category={item.category}>
											<div class="improvement-card" style="background: #fefce8; border-color: #facc15;">
												<div class="card-header">
													<h3 class="card-title">{tt(item.title)}</h3>
													<span class={`category-badge category-${item.category.toLowerCase()}`}>
														{item.category}
													</span>
												</div>

												<p>{tt(item.description)}</p>

												<!-- Target (for planned items) -->
												<div class="before-after" style="background: white;">
													<div class="before" style="grid-column: 1 / -1; text-align: left;">
														<div class="metric-label">{tt(translations.metrics.target)}</div>
														<div class="value" style="color: #0369a1;">{tt(item.target.value)}</div>
														<div class="metric-label">{tt(item.target.metric)}</div>
													</div>
												</div>

												<div class="metrics-row">
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.effort)}:</span>
														<span class="metric-value">{tt(item.effort)}</span>
													</div>
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.roi)}:</span>
														<span class="metric-value">{tt(item.roi)}</span>
													</div>
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.date)}:</span>
														<span class="metric-value">{item.date}</span>
													</div>
												</div>

												{item.expectedImpact && (
													<div style="margin-top: 1rem; padding: 0.75rem; background: white; border-radius: 6px;">
														<div style="font-weight: 600; color: #0369a1; margin-bottom: 0.25rem;">
															{tt(translations.metrics.expectedImpact)}
														</div>
														<div style="color: var(--gray-700);">{tt(item.expectedImpact)}</div>
													</div>
												)}

												{item.sourceReport && (
													<div style="margin-top: 1rem;">
														<a href={item.sourceReport} style="color: var(--accent); text-decoration: none;">
															ğŸ“„ {tt(translations.sourceReport)} â†’
														</a>
													</div>
												)}
											</div>
										</div>
									))}
								</div>
							</div>
						)}

						<!-- In Progress Improvements Section -->
						{inProgressImprovements.length > 0 && (
							<div style="margin-top: 3rem;">
								<h2 class="text-3xl font-bold mb-4">ğŸš§ {tt(translations.sections.inProgress)}</h2>
								<div class="timeline">
									{inProgressImprovements.map((item) => (
										<div class="timeline-item" data-category={item.category}>
											<div class="improvement-card" style="background: #e0f2fe; border-color: #0369a1;">
												<div class="card-header">
													<h3 class="card-title">{tt(item.title)}</h3>
													<span class={`category-badge category-${item.category.toLowerCase()}`}>
														{item.category}
													</span>
												</div>
												<p>{tt(item.description)}</p>
												{/* Add similar structure as planned items */}
											</div>
										</div>
									))}
								</div>
							</div>
						)}

						<!-- Completed Improvements Section -->
						{completedImprovements.length > 0 && (
							<div style="margin-top: 3rem;">
								<h2 class="text-3xl font-bold mb-4">âœ… {tt(translations.sections.completed)}</h2>
								<div class="timeline">
									{completedImprovements.map((item) => (
										<div class="timeline-item" data-category={item.category}>
											<div class="improvement-card">
												<div class="card-header">
													<h3 class="card-title">{tt(item.title)}</h3>
													<span class={`category-badge category-${item.category.toLowerCase()}`}>
														{item.category}
													</span>
												</div>

												<p>{tt(item.description)}</p>

												<div class="before-after">
													<div class="before">
														<div class="metric-label">{tt(translations.metrics.before)}</div>
														<div class="value">{tt(item.before.value)}</div>
														<div class="metric-label">{tt(item.before.metric)}</div>
													</div>
													<div class="arrow">â†’</div>
													<div class="after">
														<div class="metric-label">{tt(translations.metrics.after)}</div>
														<div class={`value ${item.impactType === 'positive' ? 'impact-positive' : 'impact-negative'}`}>
															{tt(item.after.value)}
														</div>
														<div class="metric-label">{tt(item.after.metric)}</div>
													</div>
												</div>

												<div class="metrics-row">
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.impact)}:</span>
														<span class={`metric-value ${item.impactType === 'positive' ? 'impact-positive' : 'impact-negative'}`}>
															{item.impact}
														</span>
													</div>
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.effort)}:</span>
														<span class="metric-value">{tt(item.effort)}</span>
													</div>
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.roi)}:</span>
														<span class="metric-value">{tt(item.roi)}</span>
													</div>
													<div class="metric">
														<span class="metric-label">{tt(translations.metrics.date)}:</span>
														<span class="metric-value">{item.date}</span>
													</div>
												</div>

												{item.lessons && tt(item.lessons).length > 0 && (
													<div class="lessons">
														<div class="lessons-title">ğŸ’¡ {tt(translations.lessons.title)}</div>
														<ul>
															{tt(item.lessons).map((lesson: string) => (
																<li>{lesson}</li>
															))}
														</ul>
													</div>
												)}

												{item.sourceReport && (
													<div style="margin-top: 1rem;">
														<a href={item.sourceReport} style="color: var(--accent); text-decoration: none;">
															ğŸ“„ {tt(translations.sourceReport)} â†’
														</a>
													</div>
												)}
											</div>
										</div>
									))}
								</div>
							</div>
						)}
					</>
				)}

				<!-- Data Sources & Notes -->
				<div class="data-section">
					<h3 class="text-xl font-bold mb-4">ğŸ“ {tt(translations.dataSection.title)}</h3>
					<ul class="space-y-2 mb-4">
						<li><strong>{tt(translations.dataSection.analytics)}:</strong> Google Analytics 4 (Property ID: 395101361)</li>
						<li><strong>{tt(translations.dataSection.reports)}:</strong> <a href={`/${lang}/blog`} class="text-accent hover:underline">/{lang}/blog</a></li>
						<li><strong>{tt(translations.dataSection.todos)}:</strong> <code>/improvement-tracking/</code></li>
						<li><strong>{tt(translations.dataSection.autoUpdate)}:</strong> improvement-tracker {lang === 'ko' ? 'ì—ì´ì „íŠ¸ê°€ ì™„ë£Œëœ ê°œì„ ì‚¬í•­ì„ ìë™ìœ¼ë¡œ ì´ í˜ì´ì§€ì— ë°˜ì˜' : lang === 'ja' ? 'ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå®Œäº†ã—ãŸæ”¹å–„äº‹é …ã‚’è‡ªå‹•çš„ã«ã“ã®ãƒšãƒ¼ã‚¸ã«åæ˜ ' : lang === 'zh' ? 'ä»£ç†è‡ªåŠ¨å°†å·²å®Œæˆçš„æ”¹è¿›é¡¹åæ˜ åˆ°æ­¤é¡µé¢' : 'agent automatically reflects completed improvements to this page'}</li>
					</ul>
					<p class="text-gray-600">
						{tt(translations.dataSection.description)}
					</p>
				</div>
			</section>
		</main>
		<Footer lang={lang} />

		<script>
			// Category filtering
			const filterTabs = document.querySelectorAll('.filter-tab');
			const timelineItems = document.querySelectorAll('.timeline-item');

			filterTabs.forEach(tab => {
				tab.addEventListener('click', () => {
					const category = tab.dataset.category;

					// Update active tab
					filterTabs.forEach(t => t.classList.remove('active'));
					tab.classList.add('active');

					// Filter items
					timelineItems.forEach(item => {
						if (category === 'all' || item.dataset.category === category) {
							item.style.display = 'block';
						} else {
							item.style.display = 'none';
						}
					});
				});
			});
		</script>
	</body>
</html>
